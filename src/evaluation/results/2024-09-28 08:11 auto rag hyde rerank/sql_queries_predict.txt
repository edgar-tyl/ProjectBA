What is the descriiption of the apartment with the ID 14? ||| SELECT AD.DESCRIPTION FROM APARTMENTDESCRIPTION AD LEFT JOIN APARTMENTDETAILS DET ON DET.APARTMENTID = AD.APARTMENTID WHERE DET.APARTMENTID = 14 ;
Who are the current owners of each apartment? ||| SELECT A.APARTMENTADDRESS , O.OWNERNAME FROM APARTMENTOWNERSHIP AO JOIN OWNERS O ON O.OWNERID = AO.OWNERID JOIN APARTMENTDETAILS A ON AO.APARTMENTID = A.APARTMENTID ;
How many apartments are owned by each owner? ||| SELECT COUNT( AO.APARTMENTID ) AS NUMBEROFAPARTMENTS , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID ORDER BY NUMBEROFAPARTMENTS DESC ;
List all apartment that have been transferred after 2023-01-01 ||| SELECT AD.APARTMENTADDRESS , AD.SIZE , OT.DATE , OT.PRICE FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID WHERE OT.DATE > "2023-01-01" ;
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFROOMS FROM APARTMENTDETAILS AD JOIN APARTMENTDESCRIPTION D ON D.APARTMENTID = AD.APARTMENTID WHERE AD.NUMBEROFBATHROOMS > 2 AND D.DESCRIPTION NOT LIKE "%modern%" AND D.DESCRIPTION NOT LIKE "%panoramic%" AND D.DESCRIPTION NOT LIKE "%quiet%" ;
What is the total value of ownership transfers for each apartment? ||| SELECT AD.APARTMENTADDRESS , SUM( OT.PRICE ) AS TOTALVALUE FROM OWNERSHIPTRANSFERS OT INNER JOIN APARTMENTDETAILS AD ON OT.TRANSFERID = ( SELECT MAX( T1.TRANSFERID ) FROM APARTMENTOWNERSHIP T1 WHERE T1.APARTMENTID = AD.APARTMENTID ) GROUP BY AD.APARTMENTADDRESS ;
Find the owner who has bought the most expensive apartment. ||| SELECT MAX( OT.PRICE ) , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY O.OWNERID ORDER BY SUM( OT.PRICE ) DESC LIMIT 1 ;
Which owner owns more than 6 apartment? ||| SELECT O.OWNERNAME FROM OWNERS O INNER JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID HAVING COUNT( AO.APARTMENTID ) > 6 ;
List all apartments with their last transfer price and date. ||| SELECT AD.APARTMENTADDRESS , OT.DATE , OT.PRICE FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID ;
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFBATHROOMS , D.DESCRIPTION FROM APARTMENTDETAILS AD JOIN APARTMENTDESCRIPTION D ON D.APARTMENTID = AD.APARTMENTID WHERE D.DESCRIPTION LIKE "%Panoramic Views%" ;
What is the total number of rooms for all apartments owned by each owner? ||| SELECT O.OWNERNAME , SUM( AD.NUMBEROFROOMS ) FROM OWNERS O INNER JOIN APARTMENTDETAILS AD ON O.OWNERID = ( SELECT OWNERID FROM APARTMENTOWNERSHIP WHERE AD.APARTMENTID = APARTMENTID ) GROUP BY O.OWNERID ;
What is the average price of apartment transfers by year? ||| SELECT CAST ( SUM( OT.PRICE ) AS REAL ) / COUNT( DISTINCT STRFTIME ( "%Y" , OT.DATE ) ) FROM APARTMENTOWNERSHIP AO JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY STRFTIME ( "%Y" , OT.DATE ) ;
Find the most common number of rooms among all apartments. ||| SELECT COUNT( NUMBEROFROOMS ) FROM APARTMENTDETAILS GROUP BY NUMBEROFROOMS ORDER BY COUNT( NUMBEROFROOMS ) DESC LIMIT 1 ;
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT O.OWNERNAME , SUM( AD.NUMBEROFBATHROOMS ) FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN APARTMENTDETAILS AD ON AO.APARTMENTID = AD.APARTMENTID GROUP BY O.OWNERID ;
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT AD.APARTMENTADDRESS FROM APARTMENTDETAILS AD JOIN APARTMENTDESCRIPTION D ON D.APARTMENTID = AD.APARTMENTID WHERE AD.NUMBEROFBATHROOMS >= 2 AND AD.SIZE = ( SELECT MIN( SIZE ) FROM APARTMENTDETAILS ) ;
What is the total number of apartments with balconies owned by each owner? ||| SELECT COUNT( CASE WHEN BD.BALCONY THEN 1 ELSE NULL END ) AS TOTALBALCONYAPARTMENTS , O.OWNERNAME FROM APARTMENTDETAILS BD JOIN APARTMENTOWNERSHIP AO ON BD.APARTMENTID = AO.APARTMENTID JOIN OWNERS O ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID ;
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT AD.APARTMENTADDRESS , AR.RATING , AR.TEXT FROM APARTMENTRATINGS AR JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID ORDER BY AR.RATING DESC ;
List apartments with their addresses that have never received a rating of 1. ||| SELECT AD.APARTMENTADDRESS FROM APARTMENTRATINGS AR JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING != 1 GROUP BY AD.APARTMENTID HAVING COUNT( AR.RATING ) = ( SELECT COUNT( * ) FROM APARTMENTRATINGS ) - 1 ;
Get the average size of apartments by the number of rooms. ||| SELECT CAST ( SUM( AD.SIZE ) AS REAL ) / COUNT( DISTINCT AD.APARTMENTID ) FROM APARTMENTDETAILS AD INNER JOIN APARTMENTDESCRIPTION DD ON DD.APARTMENTID = AD.APARTMENTID GROUP BY AD.NUMBEROFROOMS ;
List apartments ordered by their length of the description. ||| SELECT APARTMENTID FROM APARTMENTDESCRIPTION ORDER BY LENGTH ( DESCRIPTION ) ;
Find all apartments with a maximal rating below 3. ||| SELECT DISTINCT AD.APARTMENTID FROM APARTMENTRATINGS AR JOIN APARTMENTDESCRIPTION AD ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING < 3 ;
Find the average number of rooms for apartments with and without balconies. ||| SELECT AVG ( CASE WHEN AD.BALCONY THEN AD.NUMBEROFROOMS ELSE NULL END ) AS AVGNUMBEROFROOMSWITHBALCONY , AVG ( CASE WHEN NOT AD.BALCONY THEN AD.NUMBEROFROOMS ELSE NULL END ) AS AVGNUMBEROFROOMSWITHOUTBALCONY FROM APARTMENTDETAILS AS AD ;
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT AR.RATING , OT.PRICE , RD.DESCRIPTION FROM APARTMENTDESCRIPTION RD JOIN APARTMENTRATINGS AR ON RD.APARTMENTID = AR.APARTMENTID JOIN APARTMENTOWNERSHIP AO ON AR.APARTMENTID = AO.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID WHERE AR.RATING >= 4 AND OT.PRICE > 200000 ;
Find the apartments that have a size above the average size of all apartments. ||| SELECT APARTMENTADDRESS , SIZE FROM APARTMENTDETAILS WHERE SIZE > ( SELECT AVG ( SIZE ) FROM APARTMENTDETAILS ) ;
List the owners and the total value of all apartments they have transferred. ||| SELECT O.OWNERNAME , SUM( OT.PRICE ) AS TOTALVALUE FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY O.OWNERID ;
Select all adresses of all apartments ||| SELECT AD.APARTMENTADDRESS FROM APARTMENTOWNERSHIP AO JOIN APARTMENTDETAILS AD ON AO.APARTMENTID = AD.APARTMENTID ;
Get the descriptions of apartments with a balcony ||| SELECT T1.DESCRIPTION FROM APARTMENTDESCRIPTION AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T2.BALCONY = 1 ;
Get top 5 highest-rated apartments ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFROOMS , AD.SIZE , AR.RATING FROM APARTMENTRATINGS AR JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID ORDER BY AR.RATING DESC LIMIT 5 ;
Get apartments which are bigger than 1000 ||| SELECT * FROM APARTMENTDETAILS WHERE SIZE > 1000 ;
Find apartments with more than 2 bathrooms and a rating higher than 4 ||| SELECT AD.APARTMENTADDRESS , AR.RATING FROM APARTMENTDETAILS AD JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID WHERE AD.NUMBEROFBATHROOMS > 2 AND AR.RATING > 4 ;
Find how many apartments have balconies ||| SELECT COUNT( * ) FROM APARTMENTDETAILS WHERE BALCONY = 1 ;
Find all unique owner names ||| SELECT DISTINCT OWNERNAME FROM OWNERS ;
List all apartments that have a description containing thw word 'beautiful' ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFROOMS , AD.SIZE FROM APARTMENTDETAILS AD JOIN APARTMENTDESCRIPTION D ON D.APARTMENTID = AD.APARTMENTID WHERE D.DESCRIPTION LIKE "%beautiful%" ;
Count the number of transfers each owner has been involved in ||| SELECT COUNT( OT.TRANSFERID ) AS NUMBEROFTRANSFERS , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY O.OWNERID ;
Select all Apartments which have been transfered for more than the average price ||| SELECT DISTINCT A1.APARTMENTADDRESS FROM APARTMENTDETAILS AS A1 INNER JOIN OWNERSHIPTRANSFERS AS O2 ON ( A1.APARTMENTID = 0 ) AND ( O2.TRANSFERID = ( SELECT TRANSFERID FROM OWNERSHIPTRANSFERS WHERE PRICE > ( SELECT AVG ( PRICE ) FROM OWNERSHIPTRANSFERS ) ) ) ;
Select all apartments with a rating of 5 ||| SELECT AD.APARTMENTADDRESS , AD.APARTMENTID , AR.RATING FROM APARTMENTRATINGS AR JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING = 5 ;
Find all apartments along with their transfer details ||| SELECT A.APARTMENTADDRESS , A.NUMBEROFROOMS , A.SIZE , OT.DATE AS TRANSFERDATE , OT.PRICE AS TRANSFERPRICE FROM APARTMENTDETAILS A JOIN OWNERSHIPTRANSFERS OT ON A.APARTMENTID = ( SELECT AO2.APARTMENTID FROM APARTMENTOWNERSHIP AO2 JOIN OWNERSHIPTRANSFERS OT2 ON OT2.TRANSFERID = AO2.TRANSFERID WHERE OT2.DATE = ( SELECT MAX( OT3.DATE ) FROM OWNERSHIPTRANSFERS OT3 JOIN APARTMENTOWNERSHIP AO3 ON OT3.TRANSFERID = AO3.TRANSFERID ) ) ;
List all apartments and their ratings (if available) ||| SELECT AD.APARTMENTADDRESS , AR.APARTMENTID , AR.RATING , D.DESCRIPTION FROM APARTMENTRATINGS AR LEFT JOIN APARTMENTDESCRIPTION D ON D.APARTMENTID = AR.APARTMENTID INNER JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID ;
Find the highest transfer price and the corresponding apartment address ||| SELECT ( SELECT MAX( OT.PRICE ) FROM OWNERSHIPTRANSFERS OT ) AS MAXTRANSFERPRICE , AD.APARTMENTADDRESS FROM APARTMENTDETAILS AD ;
List all transfers before the year 2022 ||| SELECT OT.DATE , OT.PRICE , OT.TRANSFERID FROM OWNERSHIPTRANSFERS OT WHERE CAST ( SUBSTR ( OT.DATE , INSTR ( OT.DATE , "-" ) + 1 , LENGTH ( OT.DATE ) ) AS INTEGER ) < 2022 ;
Get the average, minimum, and maximum size of apartments ||| SELECT AVG ( SIZE ) , MAX( SIZE ) , MIN( SIZE ) FROM RESULT ;
Find how many unique owners exist in the database ||| SELECT COUNT( DISTINCT OWNERID ) FROM OWNERS ;
List all apartments that share the same number of rooms and bathrooms ||| SELECT T1.APARTMENTADDRESS , T1.APARTMENTID , T1.NUMBEROFBATHROOMS , T1.NUMBEROFROOMS , T1.SIZE FROM APARTMENTDETAILS AS T1 JOIN APARTMENTDESCRIPTION AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE NOT EXISTS ( SELECT 1 FROM APARTMENTDETAILS AS T3 WHERE T3.APARTMENTID <> T1.APARTMENTID AND T3.NUMBEROFBATHROOMS = T1.NUMBEROFBATHROOMS AND T3.NUMBEROFROOMS = T1.NUMBEROFROOMS ) ;
Get the first 3 apartments with the highest number of rooms ||| SELECT APARTMENTID FROM APARTMENTDETAILS ORDER BY NUMBEROFROOMS DESC LIMIT 3 ;
Find apartments that either have a balcony or more than 3 rooms ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFROOMS , AD.SIZE FROM APARTMENTDETAILS AD WHERE AD.BALCONY = 1 OR AD.NUMBEROFROOMS > 3 ;
Find the average rating of apartments per number of rooms ||| SELECT AD.NUMBEROFROOMS , AVG ( AR.RATING ) FROM APARTMENTRATINGS AR JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID GROUP BY AD.NUMBEROFROOMS ;
Calculate the total price of all transfers ||| SELECT SUM( PRICE ) FROM OWNERSHIPTRANSFERS ;
List all apartments owned by 'Joy Smith' ||| SELECT A.APARTMENTADDRESS , A.NUMBEROFBATHROOMS , A.NUMBEROFROOMS , A.SIZE FROM APARTMENTOWNERSHIP AS AO INNER JOIN APARTMENTDETAILS AS A ON AO.APARTMENTID = A.APARTMENTID INNER JOIN OWNERS AS O ON O.OWNERID = AO.OWNERID WHERE O.OWNERNAME = "Joy Smith" ;
Find owners who have sold more than nine apartment ||| SELECT O.OWNERNAME FROM OWNERS O INNER JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID HAVING COUNT( AO.APARTMENTID ) > 9 ;
List apartments transferred for prices between 100,000 and 500,000 ||| SELECT AD.APARTMENTADDRESS , OT.PRICE FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID WHERE CAST ( OT.PRICE AS REAL ) BETWEEN 100000 AND 500000 ;
