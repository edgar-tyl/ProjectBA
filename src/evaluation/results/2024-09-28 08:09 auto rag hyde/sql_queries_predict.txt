What is the descriiption of the apartment with the ID 14? ||| SELECT DESCRIPTION FROM APARTMENTDESCRIPTION WHERE APARTMENTID = ( SELECT DET.APARTMENTID FROM APARTMENTDETAILS DET WHERE DET.APARTMENTADDRESS = "14" ) ;
Who are the current owners of each apartment? ||| SELECT COUNT( AO.APARTMENTID ) AS NUMBEROFAPARTMENTS , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID ;
How many apartments are owned by each owner? ||| SELECT COUNT( AO.APARTMENTID ) AS NUMBEROFAPARTMENTS , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID ORDER BY NUMBEROFAPARTMENTS DESC ;
List all apartment that have been transferred after 2023-01-01 ||| SELECT * FROM APARTMENTDETAILS AS AD INNER JOIN OWNERSHIPTRANSFERS AS OT ON OT.TRANSFERID = AD.APARTMENTID WHERE STRFTIME ( "%Y-%m-%d" , OT.DATE ) > "2023-01-01" ;
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT APARTMENTADDRESS , APARTMENTID , NUMBEROFBATHROOMS , NUMBEROFROOMS FROM APARTMENTDETAILS WHERE NUMBEROFBATHROOMS > 2 AND NUMBEROFROOMS >= 3 ;
What is the total value of ownership transfers for each apartment? ||| SELECT AD.APARTMENTADDRESS , SUM( OT.PRICE ) AS TOTAL_VALUE FROM OWNERSHIPTRANSFERS OT INNER JOIN APARTMENTOWNERSHIP AO ON OT.TRANSFERID = AO.TRANSFERID INNER JOIN APARTMENTDETAILS AD ON AO.APARTMENTID = AD.APARTMENTID GROUP BY AD.APARTMENTADDRESS ;
Find the owner who has bought the most expensive apartment. ||| SELECT O.OWNERNAME , OT.PRICE FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID ORDER BY OT.PRICE DESC LIMIT 1 ;
Which owner owns more than 6 apartment? ||| SELECT O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID HAVING COUNT( AO.APARTMENTID ) > 6 ;
List all apartments with their last transfer price and date. ||| SELECT AD.APARTMENTADDRESS , OT.DATE , OT.PRICE FROM APARTMENTDETAILS AD JOIN OWNERSHIPTRANSFERS OT ON AD.APARTMENTID = ( SELECT APARTMENTID FROM APARTMENTOWNERSHIP WHERE OT.TRANSFERID = TRANSFERID ) ORDER BY OT.DATE DESC LIMIT 1 ;
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT DESCRIPTION FROM APARTMENTDESCRIPTION WHERE DESCRIPTION LIKE "%Panoramic Views%" ;
What is the total number of rooms for all apartments owned by each owner? ||| SELECT SUM( NUMBEROFROOMS ) AS TOTAL_NUMBER_OF_ROOMS , T.OWNERNAME FROM OWNERS T JOIN APARTMENTOWNERSHIP A ON T.OWNERID = A.OWNERID JOIN APARTMENTDETAILS AD ON AD.APARTMENTID = A.APARTMENTID GROUP BY T.OWNERID ;
What is the average price of apartment transfers by year? ||| SELECT AVG ( OT.PRICE ) AS AVERAGEPRICE FROM OWNERSHIPTRANSFERS OT WHERE CAST ( STRFTIME ( "%Y" , OT.DATE ) AS INTEGER ) BETWEEN 1970 AND 2022 ;
Find the most common number of rooms among all apartments. ||| SELECT MAX( NUMBEROFROOMS ) AS MOSTCOMMONROOMS FROM APARTMENTDETAILS ;
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT DISTINCT COALESCE ( SUM( T2.NUMBEROFBATHROOMS ) , 0 ) AS TOTALNUMBEROFBATHROOMS , T1.OWNERNAME FROM OWNERS T1 LEFT JOIN APARTMENTOWNERSHIP T3 ON T3.OWNERID = T1.OWNERID INNER JOIN APARTMENTDETAILS T2 ON T3.APARTMENTID = T2.APARTMENTID GROUP BY T1.OWNERNAME ;
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT APARTMENTADDRESS , BALCONY , NUMBEROFBATHROOMS , NUMBEROFROOMS , SIZE FROM APARTMENTDETAILS WHERE NUMBEROFBATHROOMS >= 2 ORDER BY SIZE ASC LIMIT 1 ;
What is the total number of apartments with balconies owned by each owner? ||| SELECT O.OWNERNAME , SUM( CASE WHEN A.BALCONY THEN 1 ELSE 0 END ) AS TOTALAPARTMENTSWITHBALCONIES FROM APARTMENTOWNERSHIP AO INNER JOIN OWNERS O ON O.OWNERID = AO.OWNERID INNER JOIN APARTMENTDETAILS A ON AO.APARTMENTID = A.APARTMENTID GROUP BY O.OWNERID ;
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT AP.APARTMENTADDRESS , AR.RATING , AR.TEXT FROM APARTMENTDETAILS AP INNER JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AP.APARTMENTID WHERE AR.RATING IN ( SELECT MAX( RATING ) FROM APARTMENTRATINGS ) GROUP BY AP.APARTMENTID ;
List apartments with their addresses that have never received a rating of 1. ||| SELECT AD.APARTMENTADDRESS , AD.APARTMENTID FROM APARTMENTDETAILS AD LEFT JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING IS NULL ;
Get the average size of apartments by the number of rooms. ||| SELECT AVG ( AD.SIZE ) AS AVERAGESIZE FROM APARTMENTDETAILS AD GROUP BY AD.NUMBEROFROOMS ;
List apartments ordered by their length of the description. ||| SELECT T1.DESCRIPTION FROM APARTMENTDESCRIPTION AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID ORDER BY LENGTH ( T1.DESCRIPTION ) ;
Find all apartments with a maximal rating below 3. ||| SELECT T1.APARTMENTADDRESS , T1.APARTMENTID FROM APARTMENTDETAILS AS T1 INNER JOIN APARTMENTRATINGS AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T2.RATING < 3 GROUP BY T1.APARTMENTID ORDER BY COUNT( T2.RATING ) DESC LIMIT 1 ;
Find the average number of rooms for apartments with and without balconies. ||| SELECT AVG ( CASE WHEN BALCONY THEN NUMBEROFROOMS ELSE NULL END ) AS AVERAGENUMBEROFROOMSWITHBALCONY , AVG ( CASE WHEN NOT ( BALCONY ) THEN NUMBEROFROOMS ELSE NULL END ) AS AVERAGENUMBEROFROOMSWITHOUTBALCONY FROM APARTMENTDETAILS ;
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT A.APARTMENTADDRESS , AR.RATING FROM APARTMENTDETAILS A JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = A.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON A.APARTMENTID = ( SELECT APARTMENTID FROM APARTMENTOWNERSHIP WHERE OT.TRANSFERID = TRANSFERID ) WHERE AR.RATING >= 4 AND OT.PRICE > 200000 ;
Find the apartments that have a size above the average size of all apartments. ||| SELECT APARTMENTADDRESS , SIZE FROM APARTMENTDETAILS WHERE SIZE > ( SELECT AVG ( SIZE ) FROM APARTMENTDETAILS ) ;
List the owners and the total value of all apartments they have transferred. ||| SELECT DISTINCT O.OWNERNAME , SUM( OT.PRICE ) FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY O.OWNERID ;
Select all adresses of all apartments ||| SELECT AD.APARTMENTADDRESS FROM APARTMENTDETAILS AD ;
Get the descriptions of apartments with a balcony ||| SELECT DESCRIPTION FROM APARTMENTDESCRIPTION WHERE APARTMENTID IN ( SELECT APARTMENTID FROM APARTMENTDETAILS WHERE BALCONY = 1 ) ;
Get top 5 highest-rated apartments ||| SELECT APD.APARTMENTID , AR.RATING , AR.TEXT FROM APARTMENTDESCRIPTION APD INNER JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = APD.APARTMENTID ORDER BY AR.RATING DESC LIMIT 5 ;
Get apartments which are bigger than 1000 ||| SELECT APARTMENTADDRESS , NUMBEROFBATHROOMS , SIZE FROM APARTMENTDETAILS WHERE SIZE > 1000 ;
Find apartments with more than 2 bathrooms and a rating higher than 4 ||| SELECT AD.APARTMENTADDRESS , AD.APARTMENTID FROM APARTMENTRATINGS AR LEFT JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID WHERE AD.NUMBEROFBATHROOMS > 2 AND AR.RATING >= 4 ;
Find how many apartments have balconies ||| SELECT COUNT( APARTMENTID ) FROM APARTMENTDETAILS WHERE BALCONY = 1 ;
Find all unique owner names ||| SELECT DISTINCT OWNERNAME FROM OWNERS ;
List all apartments that have a description containing thw word 'beautiful' ||| SELECT AD.APARTMENTADDRESS , D.DESCRIPTION FROM APARTMENTDESCRIPTION D JOIN APARTMENTDETAILS AD ON D.APARTMENTID = AD.APARTMENTID WHERE D.DESCRIPTION LIKE "%beautiful%" ;
Count the number of transfers each owner has been involved in ||| SELECT COUNT( OT.TRANSFERID ) AS TRANSFERSINVOLVED , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY O.OWNERID ;
Select all Apartments which have been transfered for more than the average price ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFROOMS , OT.PRICE FROM APARTMENTDETAILS AD INNER JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID INNER JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID WHERE AD.NUMBEROFROOMS >= 3 AND OT.PRICE > ( SELECT AVG ( PRICE ) FROM OWNERSHIPTRANSFERS ) ;
Select all apartments with a rating of 5 ||| SELECT AD.APARTMENTADDRESS , AR.RATING , AR.TEXT FROM APARTMENTDETAILS AD JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING = 5 ;
Find all apartments along with their transfer details ||| SELECT AD.APARTMENTADDRESS , OT.DATE , OT.PRICE FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID ;
List all apartments and their ratings (if available) ||| SELECT AD.APARTMENTADDRESS , AD.APARTMENTID , AR.RATING FROM APARTMENTDETAILS AD INNER JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID ;
Find the highest transfer price and the corresponding apartment address ||| SELECT AD.APARTMENTADDRESS , MAX( OT.PRICE ) FROM APARTMENTDETAILS AD INNER JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID INNER JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY AD.APARTMENTADDRESS ;
List all transfers before the year 2022 ||| SELECT OT.DATE , OT.PRICE FROM OWNERSHIPTRANSFERS OT WHERE STRFTIME ( "%Y" , OT.DATE ) < "2022" ORDER BY OT.DATE ;
Get the average, minimum, and maximum size of apartments ||| SELECT AVG ( SIZE ) AS AVERAGESIZE , MAX( SIZE ) AS MAXSIZE , MIN( SIZE ) AS MINSIZE FROM APARTMENTDETAILS ;
Find how many unique owners exist in the database ||| SELECT COUNT( DISTINCT OWNERID ) FROM OWNERS ;
List all apartments that share the same number of rooms and bathrooms ||| SELECT DISTINCT A1.APARTMENTADDRESS FROM APARTMENTDETAILS A1 INNER JOIN APARTMENTDETAILS A2 ON A2.NUMBEROFROOMS = A1.NUMBEROFROOMS AND A2.NUMBEROFBATHROOMS = A1.NUMBEROFBATHROOMS ;
Get the first 3 apartments with the highest number of rooms ||| SELECT APARTMENTADDRESS , NUMBEROFROOMS FROM APARTMENTDETAILS ORDER BY NUMBEROFROOMS DESC LIMIT 3 ;
Find apartments that either have a balcony or more than 3 rooms ||| SELECT * FROM APARTMENTDETAILS WHERE BALCONY = 1 OR NUMBEROFROOMS > 3 ;
Find the average rating of apartments per number of rooms ||| SELECT AVG ( AR.RATING ) AS AVERAGERATING , COUNT( DISTINCT AD.NUMBEROFROOMS ) AS NUMBEROFROOMS FROM APARTMENTDETAILS AD INNER JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID GROUP BY AD.NUMBEROFROOMS ;
Calculate the total price of all transfers ||| SELECT SUM( OT.PRICE ) AS TOTALPRICE FROM OWNERSHIPTRANSFERS OT ;
List all apartments owned by 'Joy Smith' ||| SELECT AD.APARTMENTADDRESS FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERS O ON O.OWNERID = AO.OWNERID WHERE O.OWNERNAME = "Joy Smith" ;
Find owners who have sold more than nine apartment ||| SELECT COUNT( AO.APARTMENTID ) AS NUMBEROFAPARTMENTS , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID HAVING COUNT( AO.APARTMENTID ) > 9 ;
List apartments transferred for prices between 100,000 and 500,000 ||| SELECT AD.APARTMENTADDRESS , AD.APARTMENTID FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID WHERE OT.PRICE BETWEEN 100000 AND 500000 ;
