What is the descriiption of the apartment with the ID 14? ||| SELECT Description FROM ApartmentDescription WHERE ApartmentID = 14;
Who are the current owners of each apartment? ||| SELECT o.OwnerName, ad.ApartmentAddress  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN Owners o ON ao.OwnerID = o.OwnerID;
How many apartments are owned by each owner? ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID GROUP BY o.OwnerID
List all apartment that have been transferred after 2023-01-01 ||| SELECT ad.ApartmentAddress, ot.Price, ot.Date FROM ApartmentDetails ad JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID WHERE ot.Date > '2023-01-01'
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT ApartmentID, ApartmentAddress, Size FROM ApartmentDetails WHERE NumberOfBathrooms >= 3 AND NumberOfRooms >= 3;
What is the total value of ownership transfers for each apartment? ||| SELECT SUM(ot.Price) FROM OwnershipTransfers ot INNER JOIN ApartmentOwnership ao ON ot.TransferID = ao.TransferID
Find the owner who has bought the most expensive apartment. ||| SELECT o.OwnerName FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID ORDER BY ot.Price DESC LIMIT 1;
Which owner owns more than 6 apartment? ||| SELECT o.OwnerName FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID GROUP BY o.OwnerID HAVING COUNT(ao.ApartmentID) > 6;
List all apartments with their last transfer price and date. ||| SELECT ad.ApartmentAddress, ot.Price, ot.Date  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID  WHERE ot.Date = ( SELECT MAX(ot2.Date) FROM OwnershipTransfers ot2 JOIN ApartmentOwnership ao2 ON ot2.TransferID = ao2.TransferID WHERE ao2.ApartmentID = ad.ApartmentID );
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT ad.ApartmentAddress, ad.Size, ad.NumberOfRooms  FROM ApartmentDetails ad JOIN ApartmentDescription d ON ad.ApartmentID = d.ApartmentID  WHERE d.Description LIKE '%Panoramic Views%';
What is the total number of rooms for all apartments owned by each owner? ||| SELECT SUM(NumberOfRooms + NumberOfBathrooms) AS TotalNumberOfRooms, o.OwnerName FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN ApartmentDetails a ON ao.ApartmentID = a.ApartmentID GROUP BY o.OwnerID
What is the average price of apartment transfers by year? ||| SELECT AVG(PRICE) FROM OwnershipTransfers WHERE STRFTIME('%Y', Date) BETWEEN '2000' AND '2010'
Find the most common number of rooms among all apartments. ||| SELECT MAX(NumberOfRooms) AS most_common_number_of_rooms FROM ApartmentDetails GROUP BY NumberOfRooms ORDER BY COUNT(*) DESC LIMIT 1
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT t1.OwnerName, SUM(t3.NumberOfBathrooms) AS TotalBathrooms FROM Owners t1 INNER JOIN ApartmentOwnership t2 ON t1.OwnerID = t2.OwnerID INNER JOIN ApartmentDetails t3 ON t2.ApartmentID = t3.ApartmentID GROUP BY t1.OwnerName
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT ApartmentAddress, Size FROM ApartmentDetails WHERE NumberOfBathrooms >= 2 ORDER BY Size ASC LIMIT 1
What is the total number of apartments with balconies owned by each owner? ||| SELECT SUM(CASE WHEN ao.OwnerID = o.OwnerID THEN 1 ELSE 0 END) AS Count FROM ApartmentOwnership ao INNER JOIN Owners o ON ao.OwnerID = o.OwnerID INNER JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID WHERE ad.Balcony = True
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT ad.ApartmentAddress, ar.Rating, ar.Text FROM ApartmentDetails ad JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID ORDER BY ar.Rating DESC LIMIT 1
List apartments with their addresses that have never received a rating of 1. ||| SELECT T1.ApartmentAddress FROM ApartmentDetails AS T1 INNER JOIN ApartmentRatings AS T2 ON T1.ApartmentID = T2.ApartmentID WHERE T2.Rating != 1
Get the average size of apartments by the number of rooms. ||| SELECT CAST(SUM(Size) AS REAL) / COUNT(*) FROM ApartmentDetails GROUP BY NumberOfRooms
List apartments ordered by their length of the description. ||| SELECT Description FROM ApartmentDescription ORDER BY LENGTH(Description)
Find all apartments with a maximal rating below 3. ||| SELECT ad.ApartmentAddress, MAX(ar.Rating) AS HighestRating  FROM ApartmentDetails ad  JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID  WHERE ar.Rating < 3 AND ad.NumberOfRooms >= 3 AND ad.Balcony = 1
Find the average number of rooms for apartments with and without balconies. ||| SELECT      AVG(CASE WHEN Balcony THEN NumberOfRooms ELSE NULL END) AS AverageNumberOfRoomsWithBalcony,     AVG(CASE WHEN NOT Balcony THEN NumberOfRooms ELSE NULL END) AS AverageNumberOfRoomsWithoutBalcony FROM ApartmentDetails
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT      AD.ApartmentAddress,      AVG(AR.Rating) AS AverageRating FROM      ApartmentDetails AD JOIN      ApartmentOwnership AO ON AD.ApartmentID = AO.ApartmentID JOIN      OwnershipTransfers OT ON AO.TransferID = OT.TransferID JOIN      ApartmentRatings AR ON AD.ApartmentID = AR.ApartmentID WHERE      OT.Price > 200000 GROUP BY      AD.ApartmentAddress HAVING      AVG(AR.Rating) >= 4
Find the apartments that have a size above the average size of all apartments. ||| SELECT ApartmentAddress, Size FROM ApartmentDetails WHERE Size > (SELECT AVG(Size) FROM ApartmentDetails);
List the owners and the total value of all apartments they have transferred. ||| SELECT o.OwnerName, SUM(ot.Price) AS TotalValue FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID GROUP BY o.OwnerName
