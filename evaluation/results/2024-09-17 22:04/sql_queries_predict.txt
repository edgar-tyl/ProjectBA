What is the descriiption of the apartment with the ID 14? ||| SELECT Description  FROM ApartmentDescription  WHERE ApartmentID IN (SELECT ApartmentID                        FROM ApartmentDetails                        WHERE Balcony = True                        AND NumberOfRooms >= 3)  LIMIT 1;
Who are the current owners of each apartment? ||| SELECT o.OwnerName  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN Owners o ON ao.OwnerID = o.OwnerID
How many apartments are owned by each owner? ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments  FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  GROUP BY o.OwnerID;
List all apartment that have been transferred after 2023-01-01 ||| SELECT    ad.ApartmentAddress,    ot.Price,    ot.Date  FROM    ApartmentDetails ad  JOIN    ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN    OwnershipTransfers ot ON ao.TransferID = ot.TransferID  WHERE    ot.Date > '2023-01-01';
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT ApartmentAddress, ApartmentID, NumberOfRooms  FROM ApartmentDetails  WHERE NumberOfBathrooms > 2 AND NumberOfRooms >= 3;
What is the total value of ownership transfers for each apartment? ||| SELECT      ad.ApartmentAddress,     SUM(ot.Price) AS TotalValue FROM      ApartmentDetails ad  JOIN      ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN      OwnershipTransfers ot ON ao.TransferID = ot.TransferID  GROUP BY      ad.ApartmentAddress  LIMIT 10;
Find the owner who has bought the most expensive apartment. ||| SELECT o.OwnerName, ot.Price FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID ORDER BY ot.Price DESC LIMIT 1;
Which owner owns more than 6 apartment? ||| SELECT o.OwnerName  FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  GROUP BY o.OwnerID, o.OwnerName  HAVING COUNT(ao.ApartmentID) > 6;
List all apartments with their last transfer price and date. ||| SELECT    ad.ApartmentAddress,    ot.Price,    ot.Date FROM    ApartmentDetails ad    JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID    JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID WHERE    ot.Date = (SELECT MAX(ot2.Date) FROM OwnershipTransfers ot2 JOIN ApartmentOwnership ao2 ON ot2.TransferID = ao2.TransferID WHERE ao2.ApartmentID = ad.ApartmentID) LIMIT 10
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT ad.ApartmentAddress, ad.Size, ad.NumberOfRooms  FROM ApartmentDetails ad JOIN ApartmentDescription d ON ad.ApartmentID = d.ApartmentID  WHERE d.Description LIKE '%Panoramic Views%';
What is the total number of rooms for all apartments owned by each owner? ||| SELECT o.OwnerName, SUM(a.NumberOfRooms + a.NumberOfBathrooms) AS TotalNumberofRooms  FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  JOIN ApartmentDetails a ON ao.ApartmentID = a.ApartmentID  GROUP BY o.OwnerID;
What is the average price of apartment transfers by year? ||| SELECT AVG(PRICE)  FROM OwnershipTransfers  WHERE strftime('%Y', Date) BETWEEN '2000' AND '2010';
Find the most common number of rooms among all apartments. ||| SELECT NumberOfRooms FROM ApartmentDetails GROUP BY NumberOfRooms ORDER BY COUNT(*) DESC LIMIT 1;
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT o.OwnerName, SUM(ad.NumberOfBathrooms) AS TotalBathrooms FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID GROUP BY o.OwnerName;
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT      ad."ApartmentAddress",      ad."Size",      ad."NumberOfRooms",      ad."NumberOfBathrooms"  FROM      "ApartmentDetails" ad  WHERE      ad."NumberOfBathrooms" >= 2  ORDER BY      ad."Size" ASC,      ad."NumberOfBathrooms" DESC  LIMIT 10;
What is the total number of apartments with balconies owned by each owner? ||| SELECT o.OwnerName, COUNT(ad.Balcony) AS TotalBalconyApartments FROM ApartmentOwnership ao JOIN Owners o ON ao.OwnerID = o.OwnerID JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID WHERE ad.Balcony = 1 GROUP BY o.OwnerName
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT      ad.ApartmentAddress,      ar.Rating,      ar.Text FROM      ApartmentDetails ad  JOIN      ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID WHERE      NOT EXISTS (         SELECT 1 FROM ApartmentRatings sub_ar WHERE sub_ar.ApartmentID = ad.ApartmentID AND sub_ar.Rating > ar.Rating     )
List apartments with their addresses that have never received a rating of 1. ||| SELECT ad.ApartmentAddress  FROM ApartmentDetails ad LEFT JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID  WHERE ar.Rating IS NULL;
Get the average size of apartments by the number of rooms. ||| SELECT AVG(ad.Size)  FROM ApartmentDetails ad  WHERE ad.NumberOfRooms IN (SELECT AVG(ad2.NumberOfRooms) FROM ApartmentDetails ad2 GROUP BY ad2.NumberOfRooms);
List apartments ordered by their length of the description. ||| SELECT a.ApartmentAddress, d.Description, a.Size, a.NumberOfRooms, a.NumberOfBathrooms  FROM ApartmentDescription d  JOIN ApartmentDetails a ON d.ApartmentID = a.ApartmentID  ORDER BY LENGTH(d.Description)
Find all apartments with a maximal rating below 3. ||| SELECT ad.ApartmentAddress, ar.Rating  FROM ApartmentRatings ar LEFT JOIN ApartmentDetails ad ON ar.ApartmentID = ad.ApartmentID  WHERE ar.Rating < 3 LIMIT 10;
Find the average number of rooms for apartments with and without balconies. ||| SELECT      AVG(CASE WHEN Balcony THEN NumberOfRooms ELSE NULL END) AS AverageNumberOfRoomsWithBalcony,     AVG(CASE WHEN NOT Balcony THEN NumberOfRooms ELSE NULL END) AS AverageNumberOfRoomsWithoutBalcony FROM ApartmentDetails;
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT      ad.ApartmentAddress,      AVG(ar.Rating) AS AverageRating FROM      ApartmentDetails ad  JOIN      ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN      OwnershipTransfers ot ON ao.TransferID = ot.TransferID  JOIN      ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID  WHERE      ot.Price > 200000 GROUP BY      ad.ApartmentAddress HAVING      AVG(ar.Rating) >= 4 LIMIT 10;
Find the apartments that have a size above the average size of all apartments. ||| SELECT ApartmentAddress, Size  FROM ApartmentDetails  WHERE Size > (SELECT AVG(Size) FROM ApartmentDetails);
List the owners and the total value of all apartments they have transferred. ||| SELECT o.OwnerName, SUM(ot.Price) AS TotalValue FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID GROUP BY o.OwnerName;
