What is the descriiption of the apartment with the ID 14? ||| SELECT DESCRIPTION FROM APARTMENTDESCRIPTION WHERE APARTMENTID IN ( SELECT APARTMENTID FROM APARTMENTDETAILS ) ;
Who are the current owners of each apartment? ||| SELECT AD.APARTMENTADDRESS , O.OWNERNAME FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERS O ON O.OWNERID = AO.OWNERID ;
How many apartments are owned by each owner? ||| SELECT COUNT( AO.APARTMENTID ) AS NUMBEROFAPARTMENTS , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID ;
List all apartment that have been transferred after 2023-01-01 ||| SELECT AD.APARTMENTADDRESS , OT.DATE , OT.PRICE FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID WHERE OT.DATE >= DATE ( "2023-01-01" ) ;
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT APARTMENTADDRESS , APARTMENTID , NUMBEROFBATHROOMS , NUMBEROFROOMS , SIZE FROM APARTMENTDETAILS WHERE NUMBEROFBATHROOMS > 2 AND NUMBEROFROOMS >= 3 ;
What is the total value of ownership transfers for each apartment? ||| SELECT AD.APARTMENTADDRESS , SUM( OT.PRICE ) AS TOTALVALUEOFOWNERSHIPTRANSFERS FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY AD.APARTMENTADDRESS LIMIT 10 ;
Find the owner who has bought the most expensive apartment. ||| SELECT O.OWNERNAME , OT.PRICE FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID ORDER BY OT.PRICE DESC LIMIT 1 ;
Which owner owns more than 6 apartment? ||| SELECT DISTINCT O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID , O.OWNERNAME HAVING COUNT( AO.APARTMENTID ) > 6 ;
List all apartments with their last transfer price and date. ||| SELECT AD.APARTMENTADDRESS , OT.DATE , OT.PRICE FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID ;
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFBATHROOMS , AD.NUMBEROFROOMS , AD.SIZE FROM APARTMENTDETAILS AD JOIN APARTMENTDESCRIPTION D ON D.APARTMENTID = AD.APARTMENTID WHERE D.DESCRIPTION LIKE "%Panoramic Views%" ;
What is the total number of rooms for all apartments owned by each owner? ||| SELECT O.OWNERNAME , SUM( A.NUMBEROFROOMS ) AS TOTALNUMBEROFROOMS FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN APARTMENTDETAILS A ON AO.APARTMENTID = A.APARTMENTID GROUP BY O.OWNERNAME ;
What is the average price of apartment transfers by year? ||| SELECT AVG ( PRICE ) FROM OWNERSHIPTRANSFERS WHERE STRFTIME ( "%Y" , DATE ) BETWEEN "2000" AND "2010" ;
Find the most common number of rooms among all apartments. ||| SELECT COUNT( * ) AS MOSTCOMMONNUMBEROFROOMS FROM ( SELECT "NumberOfRooms" , COUNT( * ) AS COUNT FROM APARTMENTDETAILS GROUP BY "NumberOfRooms" ) AS ROOMSCOUNT ORDER BY COUNT DESC LIMIT 1 ;
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT O.OWNERNAME , SUM( AD.NUMBEROFBATHROOMS ) AS TOTALBATHROOMS FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN APARTMENTDETAILS AD ON AO.APARTMENTID = AD.APARTMENTID GROUP BY O.OWNERNAME ;
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT APARTMENTADDRESS , NUMBEROFBATHROOMS , NUMBEROFROOMS , SIZE FROM APARTMENTDETAILS WHERE NUMBEROFBATHROOMS >= 2 ORDER BY SIZE ASC LIMIT 10 ;
What is the total number of apartments with balconies owned by each owner? ||| SELECT COUNT( * ) AS TOTALAPPLIANCESWITHBALCONIES , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN APARTMENTDETAILS AD ON AO.APARTMENTID = AD.APARTMENTID WHERE AD.BALCONY = 1 GROUP BY O.OWNERNAME ;
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT AD.APARTMENTADDRESS , AR.RATING , AR.TEXT FROM APARTMENTDETAILS AD JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING IN ( SELECT MAX( RATING ) FROM APARTMENTRATINGS GROUP BY APARTMENTID ) ;
List apartments with their addresses that have never received a rating of 1. ||| SELECT AD.APARTMENTADDRESS FROM APARTMENTDETAILS AD LEFT JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING IS NULL ;
Get the average size of apartments by the number of rooms. ||| SELECT AVG ( AD.SIZE ) AS AVERAGESIZE FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID GROUP BY AD.NUMBEROFROOMS ;
List apartments ordered by their length of the description. ||| SELECT A.APARTMENTID , AD.DESCRIPTION FROM APARTMENTDESCRIPTION AD JOIN APARTMENTDETAILS A ON AD.APARTMENTID = A.APARTMENTID ORDER BY LENGTH ( AD.DESCRIPTION ) ASC LIMIT 10 ;
Find all apartments with a maximal rating below 3. ||| SELECT AD.APARTMENTADDRESS , AR.RATING FROM APARTMENTRATINGS AR LEFT JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING < 3 ;
Find the average number of rooms for apartments with and without balconies. ||| SELECT AVG ( CASE WHEN BALCONY THEN NUMBEROFROOMS ELSE NULL END ) AS AVERAGENUMBEROFROOMSWITHBALCONY , AVG ( CASE WHEN NOT BALCONY THEN NUMBEROFROOMS ELSE NULL END ) AS AVERAGENUMBEROFROOMSWITHOUTBALCONY FROM APARTMENTDETAILS ;
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT AD.DESCRIPTION , AVG ( AR.RATING ) FROM APARTMENTDESCRIPTION AD JOIN APARTMENTDETAILS AD_DETAILS ON AD_DETAILS.APARTMENTID = AD.APARTMENTID JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD_DETAILS.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD_DETAILS.APARTMENTID WHERE OT.PRICE > 200000 GROUP BY AD.DESCRIPTION HAVING AVG ( AR.RATING ) >= 4 ;
Find the apartments that have a size above the average size of all apartments. ||| SELECT A.APARTMENTADDRESS , A.SIZE FROM APARTMENTDETAILS A WHERE A.SIZE > ( SELECT AVG ( B.SIZE ) FROM APARTMENTDETAILS B ) ;
List the owners and the total value of all apartments they have transferred. ||| SELECT O.OWNERNAME , SUM( OT.PRICE ) AS TOTALVALUE FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY O.OWNERNAME ;
