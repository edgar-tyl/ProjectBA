What is the descriiption of the apartment with the ID 14? ||| SELECT Description FROM ApartmentDescription WHERE ApartmentID = 14
Who are the current owners of each apartment? ||| SELECT O.OwnerName, AO.ApartmentID  FROM ApartmentDetails AD  JOIN ApartmentOwnership AO ON AD.ApartmentID = AO.ApartmentID  JOIN Owners O ON AO.OwnerID = O.OwnerID
How many apartments are owned by each owner? ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID GROUP BY o.OwnerID
List all apartment that have been transferred after 2023-01-01 ||| SELECT ad.ApartmentAddress, ot.Price, ot.Date FROM ApartmentDetails ad INNER JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID INNER JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID WHERE ot.Date > '2023-01-01'
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT ApartmentAddress, ApartmentID, NumberOfRooms  FROM ApartmentDetails  WHERE NumberOfBathrooms > 2 AND NumberOfRooms >= 3;
What is the total value of ownership transfers for each apartment? ||| SELECT SUM(ot.Price) AS TotalValue FROM OwnershipTransfers ot INNER JOIN ApartmentOwnership ao ON ot.TransferID = ao.TransferID GROUP BY ao.ApartmentID
Find the owner who has bought the most expensive apartment. ||| SELECT o.OwnerName FROM Owners o INNER JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID INNER JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID ORDER BY ot.Price DESC LIMIT 1
Which owner owns more than 6 apartment? ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID GROUP BY o.OwnerID HAVING COUNT(ao.ApartmentID) > 6;
List all apartments with their last transfer price and date. ||| SELECT ad.ApartmentAddress, ot.Price, ot.Date  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID  WHERE ot.Date = (SELECT MAX(ot2.Date) FROM OwnershipTransfers ot2 JOIN ApartmentOwnership ao2 ON ot2.TransferID = ao2.TransferID WHERE ao2.ApartmentID = ad.ApartmentID);
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT Description FROM ApartmentDescription WHERE Description LIKE '%Panoramic Views%'
What is the total number of rooms for all apartments owned by each owner? ||| SELECT SUM(a.NumberOfRooms) AS TotalRooms, o.OwnerName FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN ApartmentDetails a ON ao.ApartmentID = a.ApartmentID GROUP BY o.OwnerID
What is the average price of apartment transfers by year? ||| SELECT AVG(PRICE) FROM OwnershipTransfers WHERE Date LIKE '19%'
Find the most common number of rooms among all apartments. ||| SELECT MAX(NumberOfRooms) AS MostCommonNumberOfRooms FROM ApartmentDetails GROUP BY NumberOfRooms ORDER BY COUNT(*) DESC LIMIT 1
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT o.OwnerName, SUM(ad.NumberOfBathrooms) AS TotalBathrooms FROM Owners o INNER JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID INNER JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID GROUP BY o.OwnerName
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT DISTINCT ApartmentID FROM ApartmentDetails WHERE NumberOfBathrooms >= 2 ORDER BY Size ASC LIMIT 1
What is the total number of apartments with balconies owned by each owner? ||| SELECT COUNT(DISTINCT o.OwnerName), SUM(CASE WHEN ad.Balcony THEN 1 ELSE 0 END) FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT ad.ApartmentAddress, ar.Rating, ar.Text  FROM ApartmentDetails ad  JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID  WHERE ar.ApartmentID IN ( SELECT MAX(ar2.ApartmentID)                           FROM ApartmentRatings ar2 GROUP BY ar2.ApartmentID );
List apartments with their addresses that have never received a rating of 1. ||| SELECT DISTINCT T2.ApartmentAddress FROM ApartmentRatings AS T1 INNER JOIN ApartmentDetails AS T2 ON T1.ApartmentID = T2.ApartmentID WHERE T1.Rating > 1
Get the average size of apartments by the number of rooms. ||| SELECT AVG(Size) FROM ApartmentDetails GROUP BY NumberOfRooms
List apartments ordered by their length of the description. ||| SELECT d.Description, ad.ApartmentID  FROM ApartmentDescription d JOIN ApartmentDetails ad ON d.ApartmentID = ad.ApartmentID  ORDER BY LENGTH(d.Description)
Find all apartments with a maximal rating below 3. ||| SELECT ad.ApartmentAddress, ad.ApartmentID FROM ApartmentDetails ad LEFT JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID WHERE ar.Rating < 3 GROUP BY ad.ApartmentAddress HAVING MAX(ar.Rating)
Find the average number of rooms for apartments with and without balconies. ||| SELECT SUM(CASE WHEN Balcony THEN NumberOfRooms ELSE 0 END) / COUNT(CASE WHEN Balcony THEN ApartmentID ELSE NULL END), SUM(CASE WHEN NOT Balcony THEN NumberOfRooms ELSE 0 END) / COUNT(CASE WHEN NOT Balcony THEN ApartmentID ELSE NULL END) FROM ApartmentDetails
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT T1.ApartmentAddress, T1.ApartmentID FROM ApartmentDetails AS T1 INNER JOIN Result AS T2 ON T1.ApartmentID = T2.ApartmentID INNER JOIN OwnershipTransfers AS T3 ON T1.ApartmentID = ( SELECT T4.ApartmentID FROM ApartmentOwnership AS T4 WHERE T4.TransferID = T3.TransferID ) INNER JOIN ApartmentRatings AS T5 ON T1.ApartmentID = T5.ApartmentID GROUP BY T1.ApartmentAddress, T2.Balcony HAVING SUM(T5.Rating) >= 16
Find the apartments that have a size above the average size of all apartments. ||| SELECT T1.ApartmentAddress, T2.Size  FROM ApartmentDetails AS T2 INNER JOIN Result AS T1 ON T2.ApartmentID = T1.ApartmentID WHERE T2.Size > ( SELECT AVG(Size) FROM ApartmentDetails );
List the owners and the total value of all apartments they have transferred. ||| SELECT o.OwnerName, SUM(ot.Price) AS TotalValue FROM Owners o INNER JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID INNER JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID GROUP BY o.OwnerID
