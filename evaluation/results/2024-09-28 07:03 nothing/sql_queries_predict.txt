What is the descriiption of the apartment with the ID 14? ||| SELECT DESCRIPTION FROM APARTMENTDESCRIPTION WHERE APARTMENTID = 14 ;
Who are the current owners of each apartment? ||| SELECT T1.OWNERID , T2.OWNERNAME FROM APARTMENTOWNERSHIP AS T1 INNER JOIN OWNERS AS T2 ON T2.OWNERID = T1.OWNERID ;
How many apartments are owned by each owner? ||| SELECT COUNT( T2.APARTMENTID ) , T1.OWNERID FROM OWNERS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T2 ON T2.OWNERID = T1.OWNERID GROUP BY T1.OWNERID ;
List all apartment that have been transferred after 2023-01-01 ||| SELECT T1.APARTMENTID FROM APARTMENTOWNERSHIP AS T1 INNER JOIN OWNERSHIPTRANSFERS AS T2 ON T2.TRANSFERID = T1.TRANSFERID WHERE T2.DATE > "2023-01-01" ;
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT DISTINCT T1.APARTMENTID FROM APARTMENTDETAILS AS T1 INNER JOIN RESULT AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T1.NUMBEROFROOMS >= 3 AND T2.NUMBEROFBATHROOMS > 2 ;
What is the total value of ownership transfers for each apartment? ||| SELECT SUM( T2.PRICE ) FROM APARTMENTOWNERSHIP AS T1 INNER JOIN OWNERSHIPTRANSFERS AS T2 ON T2.TRANSFERID = T1.TRANSFERID GROUP BY T1.APARTMENTID ;
Find the owner who has bought the most expensive apartment. ||| SELECT T1.OWNERID FROM OWNERS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T2 ON T2.OWNERID = T1.OWNERID INNER JOIN OWNERSHIPTRANSFERS AS T3 ON T3.TRANSFERID = T2.TRANSFERID ORDER BY T3.PRICE DESC LIMIT 1 ;
Which owner owns more than 6 apartment? ||| SELECT T2.OWNERID FROM APARTMENTOWNERSHIP AS T1 INNER JOIN OWNERS AS T2 ON T2.OWNERID = T1.OWNERID GROUP BY T1.APARTMENTID HAVING COUNT( T1.OWNERID ) > 6 ;
List all apartments with their last transfer price and date. ||| SELECT T1.APARTMENTADDRESS FROM APARTMENTDETAILS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T2 ON T2.APARTMENTID = T1.APARTMENTID INNER JOIN OWNERSHIPTRANSFERS AS T3 ON T3.TRANSFERID = T2.TRANSFERID ORDER BY T3.DATE DESC LIMIT 1 ;
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT * FROM "ApartmentDescription" WHERE DESCRIPTION LIKE "%Panoramic Views%" ;
What is the total number of rooms for all apartments owned by each owner? ||| SELECT COUNT( T2.NUMBEROFROOMS ) , T1.OWNERID FROM OWNERS AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.OWNERID GROUP BY T1.OWNERID ;
What is the average price of apartment transfers by year? ||| SELECT CAST ( SUM( CASE WHEN STRFTIME ( "%Y" , `DATE` ) = "1991" THEN PRICE ELSE 0 END ) AS REAL ) + CAST ( SUM( CASE WHEN STRFTIME ( "%Y" , `DATE` ) = "2005" THEN PRICE ELSE 0 END ) AS REAL ) + CAST ( SUM( CASE WHEN STRFTIME ( "%Y" , `DATE` ) = "1973" THEN PRICE ELSE 0 END ) AS REAL ) , STRFTIME ( "%Y" , `DATE` ) FROM OWNERSHIPTRANSFERS ;
Find the most common number of rooms among all apartments. ||| SELECT MAX( NUMBEROFROOMS ) FROM APARTMENTDETAILS ;
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT COUNT( T2.NUMBEROFBATHROOMS ) , T1.OWNERID FROM OWNERS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T3 ON T3.OWNERID = T1.OWNERID INNER JOIN APARTMENTDETAILS AS T2 ON T3.APARTMENTID = T2.APARTMENTID GROUP BY T1.OWNERNAME ;
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT APARTMENTADDRESS FROM APARTMENTDETAILS WHERE NUMBEROFBATHROOMS >= 2 ORDER BY SIZE ASC LIMIT 1 ;
What is the total number of apartments with balconies owned by each owner? ||| SELECT SUM( CASE WHEN T2.BALCONY THEN 1 ELSE 0 END ) , T3.OWNERID FROM APARTMENTOWNERSHIP AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID INNER JOIN OWNERS AS T3 ON T3.OWNERID = T1.OWNERID ;
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT T1.DESCRIPTION AS APARTMENT_DESCRIPTION , T3.RATING , T3.TEXT AS LATEST_REVIEW FROM APARTMENTDESCRIPTION AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID INNER JOIN APARTMENTRATINGS AS T3 ON T3.APARTMENTID = T2.APARTMENTID ORDER BY T2.APARTMENTID DESC ;
List apartments with their addresses that have never received a rating of 1. ||| SELECT T2.APARTMENTADDRESS FROM APARTMENTRATINGS AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T1.RATING != 1 ;
Get the average size of apartments by the number of rooms. ||| SELECT AVG ( SIZE ) FROM APARTMENTDETAILS GROUP BY NUMBEROFROOMS ;
List apartments ordered by their length of the description. ||| SELECT APARTMENTID FROM APARTMENTDESCRIPTION ORDER BY LENGTH ( DESCRIPTION ) ;
Find all apartments with a maximal rating below 3. ||| SELECT DISTINCT T1.APARTMENTID FROM APARTMENTRATINGS AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T1.RATING < 3 ORDER BY T2.NUMBEROFBATHROOMS DESC LIMIT 1 ;
Find the average number of rooms for apartments with and without balconies. ||| SELECT AVG ( CASE WHEN BALCONY = 0 THEN NUMBEROFROOMS ELSE NULL END ) AS AVERAGENUMBEROFROOMSWITHOUTBALCONY , AVG ( CASE WHEN BALCONY = 1 THEN NUMBEROFROOMS ELSE NULL END ) AS AVERAGENUMBEROFROOMSWITHBALCONY FROM APARTMENTDETAILS ;
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT DISTINCT T1.APARTMENTID FROM APARTMENTOWNERSHIP AS T1 INNER JOIN OWNERSHIPTRANSFERS AS T2 ON T2.TRANSFERID = T1.TRANSFERID INNER JOIN APARTMENTRATINGS AS T3 ON T3.APARTMENTID = T1.APARTMENTID WHERE CAST ( T3.RATING AS REAL ) >= 4 AND T2.PRICE > 200000 ;
Find the apartments that have a size above the average size of all apartments. ||| SELECT * FROM APARTMENTDETAILS WHERE SIZE > ( SELECT AVG ( SIZE ) FROM APARTMENTDETAILS ) ;
List the owners and the total value of all apartments they have transferred. ||| SELECT DISTINCT COALESCE ( SUM( T1.PRICE ) , 0 ) , T2.OWNERNAME FROM OWNERSHIPTRANSFERS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T3 ON T3.TRANSFERID = T1.TRANSFERID INNER JOIN OWNERS AS T2 ON T3.OWNERID = T2.OWNERID GROUP BY T2.OWNERNAME ;
Select all adresses of all apartments ||| SELECT T2.APARTMENTADDRESS FROM APARTMENTRATINGS AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID ;
Get the descriptions of apartments with a balcony ||| SELECT T1.DESCRIPTION FROM APARTMENTDESCRIPTION AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T2.BALCONY = 1 ;
Get top 5 highest-rated apartments ||| SELECT * FROM APARTMENTRATINGS WHERE RATING IN ( SELECT DISTINCT MAX( RATING ) FROM APARTMENTRATINGS ) LIMIT 5 ;
Get apartments which are bigger than 1000 ||| SELECT * FROM `APARTMENTDETAILS` WHERE `SIZE` > 1000 ;
Find apartments with more than 2 bathrooms and a rating higher than 4 ||| SELECT DISTINCT T1.APARTMENTADDRESS FROM APARTMENTDETAILS AS T1 INNER JOIN APARTMENTRATINGS AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T1.NUMBEROFBATHROOMS > 2 AND T2.RATING > 4 ;
Find how many apartments have balconies ||| SELECT SUM( CASE WHEN BALCONY = 1 THEN 1 ELSE 0 END ) FROM APARTMENTDETAILS ;
Find all unique owner names ||| SELECT DISTINCT OWNERNAME FROM OWNERS ;
List all apartments that have a description containing thw word 'beautiful' ||| SELECT * FROM APARTMENTDESCRIPTION WHERE DESCRIPTION LIKE "%beautiful%" ;
Count the number of transfers each owner has been involved in ||| SELECT COUNT( T1.TRANSFERID ) , T2.OWNERID FROM OWNERSHIPTRANSFERS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T2 ON T2.TRANSFERID = T1.TRANSFERID GROUP BY T2.OWNERID ;
Select all Apartments which have been transfered for more than the average price ||| SELECT T1.APARTMENTID FROM APARTMENTDETAILS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T2 ON T2.APARTMENTID = T1.APARTMENTID INNER JOIN OWNERSHIPTRANSFERS AS T3 ON T3.TRANSFERID = T2.TRANSFERID WHERE T3.PRICE > ( SELECT AVG ( PRICE ) FROM OWNERSHIPTRANSFERS ) ;
Select all apartments with a rating of 5 ||| SELECT DISTINCT T1.APARTMENTID FROM APARTMENTRATINGS AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T1.RATING = 5 ;
Find all apartments along with their transfer details ||| SELECT T1.APARTMENTID , T2.TRANSFERID , T3.DATE , T3.PRICE FROM APARTMENTDETAILS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T2 ON T2.APARTMENTID = T1.APARTMENTID INNER JOIN OWNERSHIPTRANSFERS AS T3 ON T3.TRANSFERID = T2.TRANSFERID ;
List all apartments and their ratings (if available) ||| SELECT T1.APARTMENTID , T1.SIZE , T2.RATING FROM APARTMENTDETAILS AS T1 INNER JOIN APARTMENTRATINGS AS T2 ON T2.APARTMENTID = T1.APARTMENTID ;
Find the highest transfer price and the corresponding apartment address ||| SELECT MAX( T2.PRICE ) , T1.APARTMENTADDRESS FROM APARTMENTDETAILS AS T1 INNER JOIN OWNERSHIPTRANSFERS AS T2 ON T2.TRANSFERID = T1.APARTMENTID ;
List all transfers before the year 2022 ||| SELECT * FROM "OwnershipTransfers" WHERE STRFTIME ( "%Y" , `DATE` ) < "2022" ;
Get the average, minimum, and maximum size of apartments ||| SELECT AVG ( SIZE ) , MAX( SIZE ) , MIN( SIZE ) FROM APARTMENTDETAILS ;
Find how many unique owners exist in the database ||| SELECT COUNT( DISTINCT "OwnerID" ) FROM "Owners" ;
List all apartments that share the same number of rooms and bathrooms ||| SELECT A1.APARTMENTID FROM APARTMENTDETAILS AS A1 INNER JOIN APARTMENTDETAILS AS A2 ON A2.NUMBEROFBATHROOMS = A1.NUMBEROFROOMS WHERE ( A2.NUMBEROFROOMS != A1.NUMBEROFROOMS ) AND A1.APARTMENTID < A2.APARTMENTID ;
Get the first 3 apartments with the highest number of rooms ||| SELECT * FROM APARTMENTDETAILS ORDER BY NUMBEROFROOMS DESC LIMIT 3 ;
Find apartments that either have a balcony or more than 3 rooms ||| SELECT * FROM APARTMENTDETAILS WHERE BALCONY = 1 OR NUMBEROFROOMS > 3 ;
Find the average rating of apartments per number of rooms ||| SELECT "2" , CAST ( SUM( CASE WHEN T2.NUMBEROFROOMS = 2 THEN T1.RATING ELSE 0 END ) AS REAL ) / COUNT( T1.APARTMENTID ) FROM APARTMENTRATINGS AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID UNION SELECT "3" , CAST ( SUM( CASE WHEN T2.NUMBEROFROOMS = 3 THEN T1.RATING ELSE 0 END ) AS REAL ) / COUNT( T1.APARTMENTID ) FROM APARTMENTRATINGS AS T1 INNER JOIN APARTMENTDETAILS AS T2 ON T2.APARTMENTID = T1.APARTMENTID ;
Calculate the total price of all transfers ||| SELECT SUM( `PRICE` ) FROM `OWNERSHIPTRANSFERS` ;
List all apartments owned by 'Joy Smith' ||| SELECT T1.APARTMENTID FROM OWNERS AS T2 INNER JOIN APARTMENTOWNERSHIP AS T1 ON T2.OWNERID = T1.OWNERID WHERE T2.OWNERNAME = "Joy Smith" ;
Find owners who have sold more than nine apartment ||| SELECT T1.OWNERID FROM OWNERS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T2 ON T2.OWNERID = T1.OWNERID GROUP BY T1.OWNERID HAVING COUNT( T1.OWNERID ) > 9 ;
List apartments transferred for prices between 100,000 and 500,000 ||| SELECT T1.APARTMENTADDRESS FROM APARTMENTDETAILS AS T1 INNER JOIN APARTMENTOWNERSHIP AS T2 ON T2.APARTMENTID = T1.APARTMENTID INNER JOIN OWNERSHIPTRANSFERS AS T3 ON T3.TRANSFERID = T2.TRANSFERID WHERE CAST ( T3.PRICE AS REAL ) BETWEEN 100000 AND 500000 ;
