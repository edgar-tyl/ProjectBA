What is the descriiption of the apartment with the ID 14? ||| SELECT Description FROM ApartmentDescription WHERE ApartmentID IN (SELECT ApartmentID FROM ApartmentDetails WHERE ApartmentID NOT IN (SELECT ApartmentID FROM temp)) LIMIT 1;
Who are the current owners of each apartment? ||| SELECT      ad."ApartmentID",      o."OwnerName"  FROM      "ApartmentDetails" ad  JOIN      "ApartmentOwnership" ao ON ad."ApartmentID" = ao."ApartmentID"  JOIN      "Owners" o ON ao."OwnerID" = o."OwnerID"
How many apartments are owned by each owner? ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments  FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  GROUP BY o.OwnerID
List all apartment that have been transferred after 2023-01-01 ||| SELECT * FROM ApartmentDetails JOIN ApartmentOwnership ON ApartmentDetails.ApartmentID = ApartmentOwnership.ApartmentID JOIN OwnershipTransfers ON ApartmentOwnership.TransferID = OwnershipTransfers.TransferID WHERE strftime('%Y-%m-%d', OwnershipTransfers.Date) > '2023-01-01';
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT ApartmentAddress, ApartmentID, Size, NumberOfRooms, NumberOfBathrooms  FROM ApartmentDetails  WHERE NumberOfBathrooms > 2 AND NumberOfRooms >= 3;
What is the total value of ownership transfers for each apartment? ||| SELECT      ad.ApartmentAddress,      SUM(ot.Price)  FROM      ApartmentDetails ad  JOIN      ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN      OwnershipTransfers ot ON ao.TransferID = ot.TransferID  GROUP BY      ad.ApartmentAddress  LIMIT 10;
Find the owner who has bought the most expensive apartment. ||| SELECT o.OwnerName FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID ORDER BY ot.Price DESC LIMIT 1;
Which owner owns more than 6 apartment? ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments  FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  GROUP BY o.OwnerID  HAVING COUNT(ao.ApartmentID) > 6;
List all apartments with their last transfer price and date. ||| SELECT ad.ApartmentAddress, ot.Price, ot.Date  FROM ApartmentDetails ad JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID WHERE ot.Date = (SELECT MAX(ot2.Date) FROM OwnershipTransfers ot2 JOIN ApartmentOwnership ao2 ON ot2.TransferID = ao2.TransferID WHERE ao2.ApartmentID = ad.ApartmentID)
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT ad.ApartmentAddress, ad.Size, ad.NumberOfRooms  FROM ApartmentDetails ad  JOIN ApartmentDescription dd ON ad.ApartmentID = dd.ApartmentID  WHERE dd.Description LIKE '%Panoramic Views';
What is the total number of rooms for all apartments owned by each owner? ||| SELECT o.OwnerName, SUM(a.NumberOfRooms+a.NumberOfBathrooms) AS TotalRooms  FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  JOIN ApartmentDetails a ON ao.ApartmentID = a.ApartmentID  GROUP BY o.OwnerName;
What is the average price of apartment transfers by year? ||| SELECT AVG(PRICE)  FROM OwnershipTransfers  WHERE DATE > '1973-1-1' AND DATE < '1999-12-31';
Find the most common number of rooms among all apartments. ||| SELECT DISTINCT NumberOfRooms, COUNT(*) AS CountOfRooms FROM ApartmentDetails GROUP BY NumberOfRooms ORDER BY CountOfRooms DESC LIMIT 1;
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT o.OwnerName, SUM(ad.NumberOfBathrooms) AS TotalBathrooms FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID GROUP BY o.OwnerName;
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT      ad.ApartmentID,     ad.Size,     ad.NumberOfRooms,     ad.NumberOfBathrooms,     ad.Balcony FROM      ApartmentDetails ad WHERE      ad.NumberOfBathrooms >= 2 ORDER BY      ad.Size ASC LIMIT 10;
What is the total number of apartments with balconies owned by each owner? ||| SELECT ao.OwnerID, COUNT(*) AS TotalApartmentsWithBalconies FROM ApartmentOwnership ao JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID WHERE ad.Balcony = 1 GROUP BY ao.OwnerID;
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT      ad.ApartmentAddress,     ar.Rating,     ar.Text FROM      ApartmentDetails ad JOIN      ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID ORDER BY      ar.ApartmentID DESC LIMIT 10;
List apartments with their addresses that have never received a rating of 1. ||| SELECT      ad.ApartmentAddress,      ad.ApartmentID,      'No rating' AS Rating FROM      ApartmentDetails ad WHERE      NOT EXISTS (         SELECT 1 FROM ApartmentRatings ar WHERE ar.ApartmentID = ad.ApartmentID AND ar.Rating = 1     )
Get the average size of apartments by the number of rooms. ||| SELECT AVG(ad.Size)  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  GROUP BY ad.NumberOfRooms;
List apartments ordered by their length of the description. ||| SELECT ad.ApartmentID, d.Description, ad.ApartmentAddress  FROM ApartmentDescription d JOIN ApartmentDetails ad ON d.ApartmentID = ad.ApartmentID  ORDER BY LENGTH(d.Description) DESC  LIMIT 10;
Find all apartments with a maximal rating below 3. ||| SELECT ar.ApartmentID, ad.Description  FROM ApartmentRatings ar LEFT JOIN ApartmentDescription ad ON ar.ApartmentID = ad.ApartmentID  WHERE ar.Rating < 3  LIMIT 10;
Find the average number of rooms for apartments with and without balconies. ||| SELECT      AVG(CASE WHEN Balcony THEN NumberOfRooms ELSE NULL END) AS 'Average number of rooms with balcony',     AVG(CASE WHEN NOT Balcony THEN NumberOfRooms ELSE NULL END) AS 'Average number of rooms without balcony' FROM ApartmentDetails
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT ad.ApartmentAddress, AVG(ar.Rating) AS AverageRating  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID  JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID  WHERE ot.Price > 200000  GROUP BY ad.ApartmentAddress  HAVING AVG(ar.Rating) >= 4
Find the apartments that have a size above the average size of all apartments. ||| SELECT ApartmentAddress, Size  FROM ApartmentDetails  WHERE Size > (SELECT AVG(Size) FROM ApartmentDetails);
List the owners and the total value of all apartments they have transferred. ||| SELECT o.OwnerName, SUM(ot.Price) AS TotalValue FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID GROUP BY o.OwnerName LIMIT 10;
