What is the descriiption of the apartment with the ID 14? ||| SELECT Description FROM ApartmentDescription WHERE ApartmentID = 14
Who are the current owners of each apartment? ||| SELECT T2.OwnerName FROM ApartmentOwnership AS T1 INNER JOIN Owners AS T2 ON T1.OwnerID = T2.OwnerID WHERE T1.ApartmentID IN ( SELECT ApartmentID FROM ApartmentDetails )
How many apartments are owned by each owner? ||| SELECT COUNT(T2.ApartmentID) FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.OwnerID = T2.OwnerID GROUP BY T1.OwnerName
List all apartment that have been transferred after 2023-01-01 ||| SELECT T2.ApartmentID FROM OwnershipTransfers AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.TransferID = T2.TransferID WHERE SUBSTR(CAST(T1.Date AS TEXT), 1, 4) > '2023'
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT * FROM ApartmentDetails WHERE NumberOfBathrooms > 2 AND NumberOfRooms >= 3
What is the total value of ownership transfers for each apartment? ||| SELECT SUM(T2.Price) FROM ApartmentOwnership AS T1 INNER JOIN OwnershipTransfers AS T2 ON T1.TransferID = T2.TransferID GROUP BY T1.ApartmentID
Find the owner who has bought the most expensive apartment. ||| SELECT T2.OwnerName FROM ApartmentOwnership AS T1 INNER JOIN Owners AS T2 ON T1.OwnerID = T2.OwnerID INNER JOIN OwnershipTransfers AS T3 ON T1.TransferID = T3.TransferID WHERE T3.Price = ( SELECT MAX(T3.Price) FROM ApartmentOwnership AS T1 INNER JOIN OwnershipTransfers AS T3 ON T1.TransferID = T3.TransferID )
Which owner owns more than 6 apartment? ||| SELECT T1.OwnerID FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.OwnerID = T2.OwnerID GROUP BY T1.OwnerID HAVING COUNT(T1.OwnerID) > 6
List all apartments with their last transfer price and date. ||| SELECT DISTINCT T2.ApartmentID, T3.Price, T3.Date FROM ApartmentDetails AS T1 INNER JOIN ApartmentDescription AS T2 ON T1.ApartmentID = T2.ApartmentID INNER JOIN OwnershipTransfers AS T3 ON T2.ApartmentID = T3.TransferID ORDER BY T2.ApartmentID
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT DISTINCT ApartmentID FROM ApartmentDescription WHERE Description LIKE '%Panoramic%Views%'
What is the total number of rooms for all apartments owned by each owner? ||| SELECT COUNT(T1.NumberOfRooms) ,  T2.OwnerName FROM ApartmentDetails AS T1 INNER JOIN Owners AS T2 ON T1.ApartmentID = T2.OwnerID GROUP BY T2.OwnerID
What is the average price of apartment transfers by year? ||| SELECT CAST(SUM(CASE WHEN STRFTIME('%Y', `Date`) = '1991' THEN Price ELSE 0 END) + SUM(CASE WHEN STRFTIME('%Y', `Date`) = '1973' THEN Price ELSE 0 END) AS REAL) / COUNT(T1.TransferID) FROM OwnershipTransfers AS T1
Find the most common number of rooms among all apartments. ||| SELECT NumberOfRooms FROM ApartmentDetails GROUP BY NumberOfRooms ORDER BY COUNT(NumberOfRooms) DESC LIMIT 1
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT T1.OwnerID, COUNT(T2.NumberOfBathrooms) FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T3 ON T1.OwnerID = T3.OwnerID INNER JOIN ApartmentDetails AS T2 ON T3.ApartmentID = T2.ApartmentID GROUP BY T1.OwnerID
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT DISTINCT T2.ApartmentID FROM ApartmentRatings AS T1 INNER JOIN ApartmentDetails AS T2 ON T1.ApartmentID = T2.ApartmentID WHERE T2.NumberOfBathrooms >= 2 ORDER BY T2.Size LIMIT 1
What is the total number of apartments with balconies owned by each owner? ||| SELECT SUM(CASE WHEN T1.Balcony = 1 THEN 1 ELSE 0 END) FROM ApartmentDetails AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.ApartmentID = T2.ApartmentID INNER JOIN Owners AS T3 ON T2.OwnerID = T3.OwnerID
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT T1.ApartmentID, T3.Text, T3.Rating FROM ApartmentDetails AS T1 INNER JOIN ApartmentRatings AS T2 ON T1.ApartmentID = T2.ApartmentID INNER JOIN ( SELECT ApartmentID, MAX(Rating) AS Rating, Text FROM ApartmentRatings GROUP BY ApartmentID ) AS T3 ON T2.ApartmentID = T3.ApartmentID
List apartments with their addresses that have never received a rating of 1. ||| SELECT T.ApartmentAddress FROM ApartmentDetails AS T INNER JOIN ApartmentRatings AS S ON T.ApartmentID = S.ApartmentID WHERE S.Rating > 1
Get the average size of apartments by the number of rooms. ||| SELECT AVG(Size) FROM ApartmentDetails GROUP BY NumberOfRooms
List apartments ordered by their length of the description. ||| SELECT DISTINCT T1.ApartmentID FROM ApartmentDescription AS T1 INNER JOIN ApartmentDetails AS T2 ON T1.ApartmentID = T2.ApartmentID WHERE LENGTH(T1.Description) ORDER BY LENGTH(T1.Description) DESC LIMIT 10
Find all apartments with a maximal rating below 3. ||| SELECT DISTINCT T2.ApartmentID FROM ApartmentRatings AS T1 INNER JOIN ApartmentDetails AS T2 ON T1.ApartmentID = T2.ApartmentID WHERE T1.Rating < 3 GROUP BY T2.ApartmentID HAVING MAX(T1.Rating) < 3
Find the average number of rooms for apartments with and without balconies. ||| SELECT AVG(NumberOfRooms) FROM ApartmentDetails WHERE Balcony = 1 UNION SELECT AVG(NumberOfRooms) FROM ApartmentDetails WHERE Balcony = 0
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT DISTINCT T1.ApartmentID FROM ApartmentDetails AS T1 INNER JOIN ApartmentRatings AS T2 ON T1.ApartmentID = T2.ApartmentID INNER JOIN OwnershipTransfers AS T3 ON T1.ApartmentID = ( SELECT T4.ApartmentID FROM ApartmentOwnership AS T4 WHERE T4.TransferID = T3.TransferID ) WHERE T2.Rating * 1 >= 4 AND T3.Price > 200000
Find the apartments that have a size above the average size of all apartments. ||| SELECT ApartmentAddress FROM ApartmentDetails WHERE Size > ( SELECT AVG(Size) FROM ApartmentDetails )
List the owners and the total value of all apartments they have transferred. ||| SELECT T1.OwnerName, SUM(T3.Price) FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.OwnerID = T2.OwnerID INNER JOIN OwnershipTransfers AS T3 ON T2.TransferID = T3.TransferID GROUP BY T1.OwnerID
