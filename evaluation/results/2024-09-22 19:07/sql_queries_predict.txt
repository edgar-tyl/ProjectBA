What is the descriiption of the apartment with the ID 14? ||| SELECT DESCRIPTION FROM APARTMENTDESCRIPTION WHERE APARTMENTID = 14 ;
Who are the current owners of each apartment? ||| SELECT O.OWNERNAME FROM OWNERSHIPTRANSFERS OT INNER JOIN APARTMENTOWNERSHIP AO ON OT.TRANSFERID = AO.TRANSFERID INNER JOIN OWNERS O ON O.OWNERID = AO.OWNERID ;
How many apartments are owned by each owner? ||| SELECT COUNT( AO.APARTMENTID ) AS NUMBEROFAPARTMENTS , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID ;
List all apartment that have been transferred after 2023-01-01 ||| SELECT A1.APARTMENTADDRESS , A1.BALCONY , A1.NUMBEROFBATHROOMS , A1.NUMBEROFROOMS , A1.SIZE FROM APARTMENTDETAILS AS A1 INNER JOIN APARTMENTOWNERSHIP AS A2 ON A2.APARTMENTID = A1.APARTMENTID INNER JOIN OWNERSHIPTRANSFERS AS O ON O.TRANSFERID = A2.TRANSFERID WHERE STRFTIME ( "%Y" , O.DATE ) > "2023" ;
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT DISTINCT APARTMENTADDRESS , APARTMENTID , NUMBEROFBATHROOMS , NUMBEROFROOMS FROM APARTMENTDETAILS WHERE NUMBEROFBATHROOMS >= 3 AND NUMBEROFROOMS >= 3 ;
What is the total value of ownership transfers for each apartment? ||| SELECT SUM( OT.PRICE ) AS TOTALVALUE FROM APARTMENTOWNERSHIP AO JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID GROUP BY AO.APARTMENTID ;
Find the owner who has bought the most expensive apartment. ||| SELECT O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID ORDER BY OT.PRICE DESC LIMIT 1 ;
Which owner owns more than 6 apartment? ||| SELECT O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID HAVING COUNT( AO.APARTMENTID ) > 6 ;
List all apartments with their last transfer price and date. ||| SELECT A.APARTMENTADDRESS , OT.DATE , OT.PRICE FROM APARTMENTDETAILS A JOIN OWNERSHIPTRANSFERS OT ON A.APARTMENTID = ( SELECT AO2.APARTMENTID FROM APARTMENTOWNERSHIP AO2 JOIN OWNERSHIPTRANSFERS OT2 ON OT2.TRANSFERID = AO2.TRANSFERID WHERE OT2.DATE = ( SELECT MAX( OT3.DATE ) FROM OWNERSHIPTRANSFERS OT3 WHERE OT3.TRANSFERID = AO2.TRANSFERID ) GROUP BY AO2.APARTMENTID ) ;
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFROOMS , AD.SIZE FROM APARTMENTDETAILS AD JOIN APARTMENTDESCRIPTION D ON D.APARTMENTID = AD.APARTMENTID WHERE D.DESCRIPTION LIKE "%Panoramic Views%" ;
What is the total number of rooms for all apartments owned by each owner? ||| SELECT O.OWNERNAME , SUM( T.NUMBEROFROOMS + T.NUMBEROFBATHROOMS ) AS TOTALNUMBEROFROOMS FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN APARTMENTDETAILS T ON T.APARTMENTID = AO.APARTMENTID GROUP BY O.OWNERID ;
What is the average price of apartment transfers by year? ||| SELECT CAST ( SUM( OT.PRICE ) AS REAL ) / COUNT( DISTINCT SUBSTR ( OT.DATE , INSTR ( OT.DATE , "-" ) + 1 ) ) FROM OWNERSHIPTRANSFERS OT ;
Find the most common number of rooms among all apartments. ||| SELECT T1.NUMBEROFROOMS FROM APARTMENTDETAILS AS T1 INNER JOIN ( SELECT DISTINCT APARTMENTID FROM APARTMENTRATINGS ) AS T2 ON T2.APARTMENTID = T1.APARTMENTID GROUP BY T1.NUMBEROFROOMS ORDER BY COUNT( T1.APARTMENTID ) DESC LIMIT 1 ;
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT O.OWNERNAME , SUM( AAD.NUMBEROFBATHROOMS ) AS TOTALBATHROOMS FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID JOIN APARTMENTDETAILS AAD ON AO.APARTMENTID = AAD.APARTMENTID GROUP BY O.OWNERID ;
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT T1.APARTMENTADDRESS , T1.NUMBEROFBATHROOMS , T1.NUMBEROFROOMS , T1.SIZE FROM APARTMENTDETAILS AS T1 INNER JOIN RESULT AS T2 ON T2.APARTMENTID = T1.APARTMENTID WHERE T1.NUMBEROFBATHROOMS >= 2 ORDER BY T1.SIZE ASC LIMIT 1 ;
What is the total number of apartments with balconies owned by each owner? ||| SELECT COUNT( DISTINCT A.APARTMENTID ) AS TOTALAPARTMENTSWITHBALCONY , O.OWNERNAME , SUM( CASE WHEN O.OWNERNAME IN ( SELECT T.OWNERNAME FROM TEMP AS T ) THEN 1 ELSE 0 END ) FROM APARTMENTDETAILS AS A INNER JOIN APARTMENTOWNERSHIP AS AO ON AO.APARTMENTID = A.APARTMENTID INNER JOIN OWNERS AS O ON O.OWNERID = AO.OWNERID WHERE A.BALCONY = 1 GROUP BY O.OWNERNAME ;
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT AD.APARTMENTADDRESS , AR.RATING , AR.TEXT FROM APARTMENTDETAILS AD JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID ;
List apartments with their addresses that have never received a rating of 1. ||| SELECT AD.APARTMENTADDRESS FROM APARTMENTDETAILS AD LEFT JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING IS NULL ;
Get the average size of apartments by the number of rooms. ||| SELECT AVG ( SIZE ) FROM APARTMENTDETAILS GROUP BY NUMBEROFROOMS ;
List apartments ordered by their length of the description. ||| SELECT D.DESCRIPTION FROM APARTMENTDESCRIPTION AS D ORDER BY LENGTH ( D.DESCRIPTION ) ;
Find all apartments with a maximal rating below 3. ||| SELECT AD.APARTMENTADDRESS , MAX( AR.RATING ) AS HIGHESTRATING FROM APARTMENTDETAILS AD LEFT JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING < 3 ;
Find the average number of rooms for apartments with and without balconies. ||| SELECT CAST ( SUM( CASE WHEN BALCONY = 0 THEN NUMBEROFROOMS ELSE 0 END ) AS REAL ) / COUNT( APARTMENTID ) , CAST ( SUM( CASE WHEN BALCONY = 1 THEN NUMBEROFROOMS ELSE 0 END ) AS REAL ) / COUNT( APARTMENTID ) FROM APARTMENTDETAILS ;
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT DISTINCT AD.APARTMENTADDRESS , AR.RATING , AVG ( AR.RATING ) AS AVERAGERATING FROM APARTMENTDETAILS AD JOIN APARTMENTOWNERSHIP AO ON AO.APARTMENTID = AD.APARTMENTID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = AO.TRANSFERID JOIN APARTMENTRATINGS AR ON AR.APARTMENTID = AD.APARTMENTID WHERE AR.RATING >= 4 AND OT.PRICE > 200000 GROUP BY AD.APARTMENTADDRESS , AR.RATING ;
Find the apartments that have a size above the average size of all apartments. ||| SELECT APARTMENTADDRESS , SIZE FROM APARTMENTDETAILS WHERE SIZE > ( SELECT AVG ( SIZE ) FROM APARTMENTDETAILS ) ;
List the owners and the total value of all apartments they have transferred. ||| SELECT O.OWNERNAME , SUM( OT.PRICE ) AS TOTALVALUE FROM OWNERS O JOIN APARTMENTOWNERSHIP A ON O.OWNERID = A.OWNERID JOIN OWNERSHIPTRANSFERS OT ON OT.TRANSFERID = A.TRANSFERID GROUP BY O.OWNERNAME ;
Select all adresses of all apartments ||| SELECT AD.APARTMENTADDRESS FROM APARTMENTDETAILS AS AD ;
Get the descriptions of apartments with a balcony ||| SELECT DESCRIPTION FROM APARTMENTDESCRIPTION WHERE DESCRIPTION LIKE "%panoramic%" ;
Get top 5 highest-rated apartments ||| SELECT AD.APARTMENTADDRESS , AD.NUMBEROFROOMS , AD.SIZE , AR.RATING FROM APARTMENTRATINGS AR JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID ORDER BY AR.RATING DESC LIMIT 5 ;
Get apartments which are bigger than 1000 ||| SELECT APARTMENTADDRESS , SIZE FROM APARTMENTDETAILS WHERE SIZE > 1000 ;
Find apartments with more than 2 bathrooms and a rating higher than 4 ||| SELECT AD.APARTMENTADDRESS , AD.APARTMENTID , AR.RATING FROM APARTMENTRATINGS AR LEFT JOIN APARTMENTDETAILS AD ON AR.APARTMENTID = AD.APARTMENTID WHERE AD.NUMBEROFBATHROOMS > 2 AND AR.RATING > 4 ;
Find how many apartments have balconies ||| SELECT COUNT( APARTMENTID ) FROM APARTMENTDETAILS WHERE BALCONY = "True" ;
Find all unique owner names ||| SELECT DISTINCT T1.OWNERNAME FROM OWNERS AS T1 ;
List all apartments that have a description containing thw word 'beautiful' ||| SELECT AD.APARTMENTADDRESS , D.DESCRIPTION FROM APARTMENTDESCRIPTION D JOIN APARTMENTDETAILS AD ON D.APARTMENTID = AD.APARTMENTID WHERE D.DESCRIPTION LIKE "%beautiful%" ;
Count the number of transfers each owner has been involved in ||| SELECT COUNT( AO.APARTMENTID ) AS NUMBEROFTRANSFERS , O.OWNERNAME FROM OWNERS O JOIN APARTMENTOWNERSHIP AO ON O.OWNERID = AO.OWNERID GROUP BY O.OWNERID ;
Select all Apartments which have been transfered for more than the average Price ||| ON ad.ApartmentID = ao.ApartmentID  JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID  WHERE ot.Price > ( SELECT CAST(SUM(ot.Price) AS REAL) / COUNT(DISTINCT ao.TransferID) FROM ApartmentOwnership ao JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID );
Select all apartments with a rating of 5 ||| SELECT rd.ApartmentAddress, ad.Size, ad.NumberOfRooms  FROM ApartmentRatings ar JOIN ApartmentDetails ad ON ar.ApartmentID = ad.ApartmentID  JOIN Result rd ON ad.ApartmentID = rd.ApartmentID WHERE ar.Rating = 5;
Find all apartments along with their transfer details ||| SELECT ad.ApartmentAddress, ot.Date, ot.Price  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID
List all apartments and their ratings (if available) ||| SELECT ad.ApartmentAddress, ad.Size, ad.NumberOfRooms, ar.Rating  FROM ApartmentRatings ar LEFT JOIN ApartmentDetails ad ON ar.ApartmentID = ad.ApartmentID
Find the highest transfer price and the corresponding apartment address ||| SELECT T1.ApartmentAddress, MAX(T2.Price) FROM ApartmentDetails AS T1 INNER JOIN OwnershipTransfers AS T2 ON T1.ApartmentID = T2.TransferID
List all transfers before the year 2022 ||| SELECT DISTINCT Date FROM OwnershipTransfers WHERE Date < "2022-01-01"
Get the average, minimum, and maximum size of apartments ||| SELECT AVG(Size), MIN(Size), MAX(Size) FROM ApartmentDetails
Find how many unique owners exist in the database ||| SELECT COUNT(DISTINCT OwnerID) FROM Owners
List all apartments that share the same number of rooms and bathrooms ||| SELECT a1.ApartmentAddress, a1.Size, a1.NumberOfRooms  FROM ApartmentDetails AS a1 INNER JOIN ApartmentDetails AS a2  ON a1.NumberOfBathrooms = a2.NumberOfBathrooms AND a1.NumberOfRooms = a2.NumberOfRooms
Get the first 3 apartments with the highest number of rooms ||| SELECT ApartmentAddress, ApartmentID, NumberOfRooms FROM ApartmentDetails ORDER BY NumberOfRooms DESC LIMIT 3
Find apartments that either have a balcony or more than 3 rooms ||| SELECT ApartmentAddress, ApartmentID, NumberOfRooms  FROM ApartmentDetails  WHERE Balcony = True OR NumberOfRooms > 3;
Find the average rating of apartments per number of rooms ||| SELECT AVG(ar.Rating) AS average_rating, ad.NumberOfRooms FROM ApartmentDetails ad JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID GROUP BY ad.NumberOfRooms
Calculate the total price of all transfers ||| SELECT SUM(TransferID) FROM OwnershipTransfers
List all apartments owned by 'Joy Smith' ||| SELECT DISTINCT a.ApartmentAddress  FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN ApartmentDetails a ON ao.ApartmentID = a.ApartmentID WHERE o.OwnerName = 'Joy Smith'
Find owners who have sold more than nine apartment ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID GROUP BY o.OwnerID HAVING COUNT(ao.ApartmentID) > 9;
List apartments transferred for prices between 100,000 and 500,000 ||| SELECT ad.ApartmentAddress  FROM ApartmentDetails ad JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID  WHERE (ot.Price > 100000) AND (ot.Price < 500000);
