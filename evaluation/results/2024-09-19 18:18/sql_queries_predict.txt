What is the descriiption of the apartment with the ID 14? ||| SELECT Description FROM ApartmentDescription WHERE ApartmentID = 14;
Who are the current owners of each apartment? ||| SELECT o.OwnerName, ao.ApartmentID FROM ApartmentOwnership ao INNER JOIN Owners o ON ao.OwnerID = o.OwnerID GROUP BY o.OwnerName ORDER BY COUNT(ao.ApartmentID) DESC LIMIT 1
How many apartments are owned by each owner? ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID GROUP BY o.OwnerID
List all apartment that have been transferred after 2023-01-01 ||| SELECT ad.ApartmentAddress, ot.Price, ot.Date FROM ApartmentDetails ad JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID WHERE ot.Date > '2023-01-01'
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT ApartmentAddress, ApartmentID, NumberOfBathrooms, NumberOfRooms  FROM ApartmentDetails  WHERE NumberOfBathrooms > 2 AND NumberOfRooms >= 3;
What is the total value of ownership transfers for each apartment? ||| SELECT SUM(ot.Price) AS TotalValueOfOwnershipTransfers FROM OwnershipTransfers ot JOIN ApartmentOwnership ao ON ot.TransferID = ao.TransferID
Find the owner who has bought the most expensive apartment. ||| SELECT o.OwnerName FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID GROUP BY o.OwnerID ORDER BY SUM(ot.Price) DESC LIMIT 1
Which owner owns more than 6 apartment? ||| SELECT o.OwnerName FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID GROUP BY o.OwnerID HAVING COUNT(ao.ApartmentID) > 6
List all apartments with their last transfer price and date. ||| SELECT ad.ApartmentAddress, ot.Date, ot.Price  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT ApartmentAddress, Size, NumberOfRooms FROM ApartmentDetails WHERE ApartmentID IN ( SELECT ApartmentID FROM ApartmentDescription WHERE Description LIKE '%Panoramic Views%')
What is the total number of rooms for all apartments owned by each owner? ||| SELECT SUM(NumberOfRooms + NumberOfBathrooms) AS TotalNumberOfRooms, o.OwnerName  FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID GROUP BY o.OwnerID
What is the average price of apartment transfers by year? ||| SELECT AVG(PRICE) FROM OwnershipTransfers WHERE Date >= "2000-1-1" AND DATE <= "2010-12-31";
Find the most common number of rooms among all apartments. ||| SELECT MAX(NumberOfRooms) AS MostCommonNumberOfRooms FROM ApartmentDetails GROUP BY NumberOfRooms ORDER BY COUNT(*) DESC LIMIT 1
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT o.OwnerName, SUM(ad.NumberOfBathrooms) AS TotalNumberOfBathrooms FROM Owners o INNER JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID INNER JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID GROUP BY o.OwnerName
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT ApartmentAddress, Size, NumberOfRooms, NumberOfBathrooms, Balcony  FROM ApartmentDetails  WHERE NumberOfBathrooms >= 2 ORDER BY Size ASC LIMIT 1
What is the total number of apartments with balconies owned by each owner? ||| SELECT SUM(CASE WHEN a.Balcony = 1 THEN 1 ELSE 0 END) AS TotalNumberApartmentWithBalconies, o.OwnerName  FROM Owners o INNER JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID INNER JOIN ApartmentDetails a ON ao.ApartmentID = a.ApartmentID
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT ad.ApartmentAddress, ar.Rating, ar.Text FROM ApartmentDetails ad JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID ORDER BY ar.ApartmentID DESC LIMIT 1
List apartments with their addresses that have never received a rating of 1. ||| SELECT ApartmentAddress FROM ApartmentDetails WHERE ApartmentID NOT IN (SELECT ApartmentID FROM ApartmentRatings WHERE Rating = 1)
Get the average size of apartments by the number of rooms. ||| SELECT AVG(Size) AS AverageSize FROM ApartmentDetails GROUP BY NumberOfRooms
List apartments ordered by their length of the description. ||| SELECT Description FROM ApartmentDescription ORDER BY LENGTH(Description)
Find all apartments with a maximal rating below 3. ||| SELECT ad.ApartmentAddress, ad.ApartmentID  FROM ApartmentRatings ar  LEFT JOIN ApartmentDetails ad ON ar.ApartmentID = ad.ApartmentID  WHERE ar.Rating < 3 GROUP BY ad.ApartmentID ORDER BY COUNT(ar.Rating) DESC LIMIT 1
Find the average number of rooms for apartments with and without balconies. ||| SELECT CAST(SUM(CASE WHEN Balcony THEN NumberOfRooms ELSE 0 END) AS REAL) / COUNT(*), CAST(SUM(CASE WHEN NOT Balcony THEN NumberOfRooms ELSE 0 END) AS REAL) / COUNT(*) FROM ApartmentDetails
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT      ad.ApartmentAddress,      ar.Rating,      ar.Text,      ot.Price,      od.Description  FROM      ApartmentDetails ad  JOIN      ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN      OwnershipTransfers ot ON ao.TransferID = ot.TransferID  JOIN      ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID  JOIN      ApartmentDescription od ON ad.ApartmentID = od.ApartmentID  WHERE      ot.Price > 200000 AND ar.Rating >= 4
Find the apartments that have a size above the average size of all apartments. ||| SELECT ApartmentAddress, Size  FROM ApartmentDetails  WHERE Size > (SELECT AVG(Size) FROM ApartmentDetails);
List the owners and the total value of all apartments they have transferred. ||| SELECT o.OwnerName, SUM(ot.Price) FROM Owners o INNER JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID INNER JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID GROUP BY o.OwnerName
