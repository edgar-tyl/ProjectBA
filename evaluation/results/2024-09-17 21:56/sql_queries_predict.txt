What is the descriiption of the apartment with the ID 14? ||| SELECT Description  FROM ApartmentDescription  WHERE ApartmentID IN (SELECT ApartmentID FROM ApartmentDetails);
Who are the current owners of each apartment? ||| SELECT o.OwnerName, ad.ApartmentID FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID
How many apartments are owned by each owner? ||| SELECT o.OwnerName, COUNT(ao.ApartmentID) AS NumberOfApartments FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID GROUP BY o.OwnerID
List all apartment that have been transferred after 2023-01-01 ||| SELECT ao.ApartmentID, ad.ApartmentAddress, ot.Date FROM ApartmentDetails ad JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID WHERE ot.Date >= '2023-01-01';
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT      ad.ApartmentAddress,      ad.ApartmentID,      ad.NumberOfRooms,      ad.NumberOfBathrooms  FROM      ApartmentDetails AS ad  WHERE      ad.NumberOfBathrooms > 2 AND      ad.NumberOfRooms >= 3;
What is the total value of ownership transfers for each apartment? ||| SELECT    ad.ApartmentID,   SUM(ot.Price) AS TotalValue FROM    ApartmentDetails ad   JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID   JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID GROUP BY    ad.ApartmentID LIMIT 10;
Find the owner who has bought the most expensive apartment. ||| SELECT o.OwnerName, ot.Price  FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID  ORDER BY ot.Price DESC  LIMIT 1;
Which owner owns more than 6 apartment? ||| SELECT o.OwnerName  FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID  GROUP BY o.OwnerID, o.OwnerName  HAVING COUNT(ao.ApartmentID) > 6;
List all apartments with their last transfer price and date. ||| SELECT    ad.ApartmentAddress,    ot.Price,    ot.Date FROM    ApartmentDetails ad  JOIN    ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN    OwnershipTransfers ot ON ao.TransferID = ot.TransferID
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT *  FROM ApartmentDescription AS ad JOIN ApartmentDetails AS a ON ad.ApartmentID = a.ApartmentID WHERE ad.Description LIKE '%Panoramic Views%';
What is the total number of rooms for all apartments owned by each owner? ||| SELECT o.OwnerName, SUM(a.NumberOfRooms+a.NumberOfBathrooms) AS TotalRooms  FROM Owners o  JOIN ApartmentOwnership ao ON o.OwnerID=ao.OwnerID  JOIN ApartmentDetails a ON ao.ApartmentID=a.ApartmentID  GROUP BY o.OwnerName;
What is the average price of apartment transfers by year? ||| SELECT AVG(PRICE)  FROM OwnershipTransfers  WHERE DATE >= "1973-01-01" AND DATE <= "2005-12-31";
Find the most common number of rooms among all apartments. ||| SELECT      NumberOfRooms FROM      ApartmentDetails GROUP BY      NumberOfRooms ORDER BY      COUNT(*) DESC LIMIT 1;
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT o.OwnerName, SUM(ad.NumberOfBathrooms) AS TotalBathrooms  FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID GROUP BY o.OwnerName
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT ApartmentAddress, Size, NumberOfRooms, NumberOfBathrooms, Balcony  FROM ApartmentDetails  WHERE NumberOfBathrooms >= 2  ORDER BY Size ASC  LIMIT 10;
What is the total number of apartments with balconies owned by each owner? ||| SELECT ao.OwnerID, count(*) AS TotalApartments FROM ApartmentOwnership ao JOIN ApartmentDetails ad ON ao.ApartmentID = ad.ApartmentID WHERE ad.Balcony = 1 GROUP BY ao.OwnerID;
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT      ad.ApartmentAddress,      ar.Rating,      ar.Text FROM      ApartmentDetails ad  JOIN      ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID  WHERE      NOT EXISTS (         SELECT 1 FROM ApartmentRatings ar2          WHERE ar2.ApartmentID = ad.ApartmentID AND ar2.Rating > ar.Rating     )
List apartments with their addresses that have never received a rating of 1. ||| SELECT ad.ApartmentAddress  FROM ApartmentRatings ar  LEFT JOIN ApartmentDetails ad ON ar.ApartmentID = ad.ApartmentID  WHERE ar.Rating > 1;
Get the average size of apartments by the number of rooms. ||| SELECT AVG(Size) AS AverageSize  FROM ApartmentDetails  GROUP BY NumberOfRooms;
List apartments ordered by their length of the description. ||| SELECT a.ApartmentAddress, d.Description FROM ApartmentDescription d JOIN ApartmentDetails a ON d.ApartmentID = a.ApartmentID ORDER BY LENGTH(d.Description)
Find all apartments with a maximal rating below 3. ||| SELECT      ad.ApartmentAddress,      ar.Rating  FROM      ApartmentRatings ar  LEFT JOIN      ApartmentDetails ad ON ar.ApartmentID = ad.ApartmentID  WHERE      ar.Rating < 3;
Find the average number of rooms for apartments with and without balconies. ||| SELECT      AVG(CASE WHEN Balcony THEN NumberOfRooms ELSE NULL END) AS WithoutBalcony,     AVG(CASE WHEN Balcony THEN NULL ELSE NumberOfRooms END) AS WithBalcony FROM ApartmentDetails
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT ad.ApartmentAddress, AVG(ar.Rating) AS AverageRating  FROM ApartmentDetails ad  JOIN ApartmentOwnership ao ON ad.ApartmentID = ao.ApartmentID  JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID  JOIN ApartmentRatings ar ON ad.ApartmentID = ar.ApartmentID  WHERE ot.Price > 200000 GROUP BY ad.ApartmentAddress HAVING AVG(ar.Rating) >= 4 LIMIT 10;
Find the apartments that have a size above the average size of all apartments. ||| SELECT ApartmentAddress, Size  FROM ApartmentDetails  WHERE Size > (SELECT AVG(Size) FROM ApartmentDetails);
List the owners and the total value of all apartments they have transferred. ||| SELECT o.OwnerName, SUM(ot.Price) AS TotalValue FROM Owners o JOIN ApartmentOwnership ao ON o.OwnerID = ao.OwnerID JOIN OwnershipTransfers ot ON ao.TransferID = ot.TransferID GROUP BY o.OwnerName;
