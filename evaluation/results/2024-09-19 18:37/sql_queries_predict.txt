What is the descriiption of the apartment with the ID 14? ||| SELECT Description FROM ApartmentDescription WHERE ApartmentID = 14
Who are the current owners of each apartment? ||| SELECT T2.OwnerID FROM ApartmentOwnership AS T1 INNER JOIN Owners AS T2 ON T1.OwnerID = T2.OwnerID WHERE T1.ApartmentID = 0 OR T1.ApartmentID = 1 OR T1.ApartmentID = 2
How many apartments are owned by each owner? ||| SELECT T1.OwnerID, COUNT(T2.ApartmentID) FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.OwnerID = T2.OwnerID GROUP BY T1.OwnerID
List all apartment that have been transferred after 2023-01-01 ||| SELECT T1.ApartmentID FROM ApartmentOwnership AS T1 INNER JOIN OwnershipTransfers AS T2 ON T1.TransferID = T2.TransferID WHERE SUBSTR(T2.Date, 1, 4) > '2023'
Which apartments have more than two bathrooms and at least three rooms? ||| SELECT * FROM ApartmentDetails WHERE NumberOfBathrooms > 2 AND NumberOfRooms >= 3
What is the total value of ownership transfers for each apartment? ||| SELECT T2.Price FROM ApartmentOwnership AS T1 INNER JOIN OwnershipTransfers AS T2 ON T1.TransferID = T2.TransferID GROUP BY T1.ApartmentID
Find the owner who has bought the most expensive apartment. ||| SELECT T1.OwnerID FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.OwnerID = T2.OwnerID INNER JOIN OwnershipTransfers AS T3 ON T2.TransferID = T3.TransferID ORDER BY T3.Price DESC LIMIT 1
Which owner owns more than 6 apartment? ||| SELECT T1.OwnerID FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.OwnerID = T2.OwnerID GROUP BY T1.OwnerID HAVING COUNT(T1.OwnerID) > 6
List all apartments with their last transfer price and date. ||| SELECT A.ApartmentID, OT.Price, OT.Date FROM ApartmentOwnership AS AO INNER JOIN OwnershipTransfers AS OT ON AO.TransferID = OT.TransferID INNER JOIN ApartmentDetails AS A ON AO.ApartmentID = A.ApartmentID WHERE AO.TransferID = ( SELECT MAX(TransferID) FROM OwnershipTransfers )
Find all apartments with a description that contains 'Panoramic Views'. ||| SELECT * FROM ApartmentDescription WHERE Description LIKE '%Panoramic Views%'
What is the total number of rooms for all apartments owned by each owner? ||| SELECT COUNT(T2.NumberOfRooms) ,  T1.OwnerName FROM Owners AS T1 INNER JOIN ApartmentDetails AS T2 ON T1.OwnerID = T2.ApartmentID GROUP BY T1.OwnerID
What is the average price of apartment transfers by year? ||| SELECT CAST(SUM(T2.Price) AS REAL) / COUNT(DISTINCT STRFTIME('%Y', T2.Date)) FROM ApartmentOwnership AS T1 INNER JOIN OwnershipTransfers AS T2 ON T1.TransferID = T2.TransferID
Find the most common number of rooms among all apartments. ||| SELECT MAX(NumberOfRooms) FROM ApartmentDetails GROUP BY NumberOfRooms ORDER BY COUNT(NumberOfRooms) DESC LIMIT 1
Retrieve the owners and the total number of bathrooms in the apartments they own. ||| SELECT T1.OwnerName, SUM(T2.NumberOfBathrooms) FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T3 ON T1.OwnerID = T3.OwnerID INNER JOIN ApartmentDetails AS T2 ON T3.ApartmentID = T2.ApartmentID GROUP BY T1.OwnerName
List the apartments with the smallest size that have at least two bathrooms. ||| SELECT ApartmentAddress FROM ApartmentDetails WHERE NumberOfBathrooms >= 2 ORDER BY Size ASC LIMIT 1
What is the total number of apartments with balconies owned by each owner? ||| SELECT T1.NumberOfBathrooms + T1.NumberOfRooms FROM ApartmentDetails AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.ApartmentID = T2.ApartmentID WHERE T1.Balcony = 1 GROUP BY T2.OwnerID
Retrieve the list of all apartments with their latest review text and rating. ||| SELECT T2.ApartmentID, T1.Text, T1.Rating FROM ApartmentRatings AS T1 INNER JOIN ApartmentDetails AS T2 ON T1.ApartmentID = T2.ApartmentID ORDER BY T2.ApartmentAddress DESC
List apartments with their addresses that have never received a rating of 1. ||| SELECT DISTINCT T2.ApartmentAddress FROM ApartmentRatings AS T1 INNER JOIN ApartmentDetails AS T2 ON T1.ApartmentID = T2.ApartmentID WHERE T1.Rating != 1
Get the average size of apartments by the number of rooms. ||| SELECT AVG(Size) FROM ApartmentDetails GROUP BY NumberOfRooms
List apartments ordered by their length of the description. ||| SELECT ApartmentID FROM ApartmentDescription ORDER BY LENGTH(Description)
Find all apartments with a maximal rating below 3. ||| SELECT T1.ApartmentID FROM ApartmentRatings AS T1 INNER JOIN ApartmentDetails AS T2 ON T1.ApartmentID = T2.ApartmentID WHERE T1.Rating < 3 GROUP BY T2.ApartmentID ORDER BY MAX(T1.Rating) LIMIT 1
Find the average number of rooms for apartments with and without balconies. ||| SELECT CAST(SUM(CASE WHEN T2.Balcony THEN T2.NumberOfRooms ELSE 0 END) AS REAL) / COUNT(T1.ApartmentID),         CAST(SUM(CASE WHEN NOT T2.Balcony THEN T2.NumberOfRooms ELSE 0 END) AS REAL) / COUNT(T1.ApartmentID) FROM ApartmentRatings AS T1 JOIN ApartmentDetails AS T2 ON T1.ApartmentID = T2.ApartmentID
List all apartments that were transferred for more than $200,000 and received an average rating of at least 4. ||| SELECT T1.ApartmentID FROM ApartmentRatings AS T1 INNER JOIN OwnershipTransfers AS T2 ON T1.ApartmentID = T2.TransferID WHERE T2.Price > 200000 AND CAST(T1.Rating AS REAL) >= 4
Find the apartments that have a size above the average size of all apartments. ||| SELECT ApartmentID FROM ApartmentDetails WHERE Size > ( SELECT AVG(Size) FROM ApartmentDetails )
List the owners and the total value of all apartments they have transferred. ||| SELECT T1.OwnerName ,  SUM(T3.Price) FROM Owners AS T1 INNER JOIN ApartmentOwnership AS T2 ON T1.OwnerID = T2.OwnerID INNER JOIN OwnershipTransfers AS T3 ON T2.TransferID = T3.TransferID GROUP BY T1.OwnerName
